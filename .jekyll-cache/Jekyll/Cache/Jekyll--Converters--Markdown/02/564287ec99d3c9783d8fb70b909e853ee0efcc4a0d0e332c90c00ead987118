I"ŞÉ<h1 id="lab1-åŠ æ³•å™¨ç”µè·¯è®¾è®¡">Lab1: åŠ æ³•å™¨ç”µè·¯è®¾è®¡</h1>

<p>åœ¨æœ¬æ–‡ä¸­, æˆ‘ä»¬å°†åŸºäº <code class="language-plaintext highlighter-rouge">Ch1, Ch2</code> æ‰€å­¦çŸ¥è¯†, æ­å»ºå®ŒæˆäºŒè¿›åˆ¶å…¨åŠ å™¨çš„ç”µè·¯è®¾è®¡, å¹¶ä»¥æ­¤ä¸ºåŸºç¡€å®ç° $4$ ä½, $16$ ä½è¡Œæ³¢è¿›ä½å…¨åŠ å™¨çš„è®¾è®¡å’Œç”µè·¯é€»è¾‘åŠŸèƒ½æµ‹è¯•.</p>

<h2 id="å…¨åŠ å™¨">å…¨åŠ å™¨</h2>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿ç»­èµ‹å€¼å¿«é€Ÿåœ°å®šä¹‰ä¸€ä¸ªå…¨åŠ å™¨. ä½†æ˜¯å¤„äºæ•™å­¦ç›®çš„, æˆ‘ä»¬æš‚ä¸”ä¸è¿™ä¹ˆåš, è€Œæ˜¯ä»çœŸå€¼è¡¨å¼€å§‹è¿›è¡Œç”µè·¯åˆ†æ, å¹¶ä½¿ç”¨ä¸é—¨, æˆ–é—¨, å¼‚æˆ–é—¨æ­å»ºå…¨åŠ å™¨:
é¦–å…ˆè€ƒè™‘åŒ…å«è¿›ä½çš„äºŒè¿›åˆ¶åŠ æ³•. ä¸å¦¨è®¾è¾“å…¥ä¸º <code class="language-plaintext highlighter-rouge">x, y, c_in</code>, æœ€ç»ˆæ•°æ®ä½è¾“å‡ºä¸º <code class="language-plaintext highlighter-rouge">(x XOR y) XOR c_in</code>, carryä½è¾“å‡ºä¸º <code class="language-plaintext highlighter-rouge">((x XOR y)AND c_in) or (x AND y)</code>. ç”µè·¯å›¾å¦‚ä¸‹æ‰€ç¤º:</p>

<p><img src="https://cdn.jsdelivr.net/gh/KirisameMarisaa/KirisameMarisaa.github.io/img/blogpost_images/20201105193753.png" alt="20201105193753" /></p>

<p>ä¾æ®ä¸Šè¿°åŸç†, ç¼–å†™ <code class="language-plaintext highlighter-rouge">Verilog</code> ç¨‹åºå¦‚ä¸‹:</p>
<div class="language-verilog highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="rouge-code"><pre><span class="c1">// Full adder design using verilog primitive gates</span>

<span class="c1">// All gates have a 1ns delay (#1 = 1ns)</span>
<span class="cp">`timescale</span> <span class="mi">1</span><span class="n">ns</span><span class="o">/</span><span class="mi">100</span><span class="n">ps</span>

<span class="cp">`default_nettype</span> <span class="n">none</span>

<span class="c1">//Module definition</span>

<span class="k">module</span> <span class="n">full_adder</span><span class="p">(</span><span class="kt">input</span>  <span class="kt">wire</span>  <span class="n">a</span><span class="p">,</span> 
                  <span class="kt">input</span>  <span class="kt">wire</span>  <span class="n">b</span><span class="p">,</span> 
                  <span class="kt">input</span>  <span class="kt">wire</span>  <span class="n">cin</span><span class="p">,</span> 
                  <span class="kt">output</span> <span class="kt">wire</span>  <span class="n">s</span><span class="p">,</span> 
                  <span class="kt">output</span> <span class="kt">wire</span>  <span class="n">cout</span><span class="p">);</span>

<span class="c1">//Internal connections should be specified here</span>
<span class="kt">wire</span> <span class="n">axorb</span><span class="p">;</span>     <span class="c1">// will be a^b</span>
<span class="kt">wire</span> <span class="n">ab</span><span class="p">;</span>        <span class="c1">// will be a.b</span>
<span class="kt">wire</span> <span class="n">cin_axorb</span><span class="p">;</span> <span class="c1">// will be cin.(a^b)</span>


<span class="c1">// Sum logic for full adder s=(a^b)^cin</span>
<span class="c1">//</span>
<span class="kt">xor</span> <span class="p">#</span><span class="mi">1</span> <span class="n">gate1</span> <span class="p">(</span><span class="n">axorb</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">xor</span> <span class="p">#</span><span class="mi">1</span> <span class="n">gate2</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">axorb</span><span class="p">);</span>

<span class="c1">// Carry logic for full adder cout=cin.(a^b) + a.b</span>
<span class="c1">//</span>
<span class="kt">and</span> <span class="p">#</span><span class="mi">1</span> <span class="n">gate3</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">and</span> <span class="p">#</span><span class="mi">1</span> <span class="n">gate4</span><span class="p">(</span><span class="n">cin_axorb</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">axorb</span><span class="p">);</span>
<span class="kt">or</span> <span class="p">#</span><span class="mi">1</span> <span class="n">gate5</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span> <span class="n">cin_axorb</span><span class="p">,</span> <span class="n">ab</span><span class="p">);</span>



<span class="k">endmodule</span> 

<span class="cp">`default_nettype</span> <span class="kt">wire</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Verilog æ˜¯ç¡¬ä»¶æè¿°è¯­è¨€, æœ¬è´¨æ˜¯å¯¹è¦å®šä¹‰çš„ç”µè·¯å›¾æˆ–è®¾è®¡çš„æ–‡å­—åŒ–æè¿°. å®ƒä»¥æ¨¡ç»„ä¸ºåŸºæœ¬å•ä½, å®šä¹‰è¾“å…¥, è¾“å‡ºä»¥åŠå¯¹è¾“å…¥ä¿¡å·çš„å¤„ç†æ–¹æ³•. åœ¨ä¸Šè¿°ä»£ç ä¸­, æˆ‘ä»¬å®šä¹‰é€»è¾‘é—¨çš„è¾“å…¥, è¿ç®—å’Œè¾“å‡º, å¹¶å£°æ˜ç›¸å…³çš„è¾“å…¥/è¾“å‡ºä¿¡å·ä¸º <code class="language-plaintext highlighter-rouge">wire</code> æ•°æ®ç±»å‹. å¯¹çº¿è·¯çš„å®šä¹‰ä¸è€ƒè™‘å…ˆåé¡ºåºé—®é¢˜, è€Œå…³æ³¨å®ƒçš„é€»è¾‘ç»“æ„. ç”µè·¯æœ¬è´¨ä¸Šå°±æ˜¯å¹¶è¡Œçš„.</p>

<p>è¦å¯¹æ‰€å®šä¹‰çš„ç”µè·¯è¿›è¡Œæµ‹è¯•, æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨æ§åˆ¶å˜é‡æ³•, ä¾æ¬¡æµ‹è¯•æ¨¡ç»„æ‰€æœ‰çš„è¾“å…¥å’Œè¾“å‡º, ä»¥åŠæ¨¡ç»„é—´è¿çº¿. åœ¨å…¨åŠ å™¨æ¨¡ç»„ä¸­, ç”±äºä¸å­˜åœ¨ä¸­é—´è¿çº¿, æˆ‘ä»¬åªéœ€è¦æµ‹è¯•ä¸‰æ¡è¾“å…¥å’Œä¸¤æ¡è¾“å‡ºå³å¯. æµ‹è¯•ä»£ç å¦‚ä¸‹:</p>

<div class="language-verilog highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre><span class="c1">// Full adder testbench</span>

<span class="c1">// #1 = 1ns</span>
<span class="cp">`timescale</span> <span class="mi">1</span><span class="n">ns</span><span class="o">/</span><span class="mi">100</span><span class="n">ps</span> 

<span class="k">module</span> <span class="n">full_adder_tb</span><span class="p">();</span>

<span class="c1">// Internal connections</span>
<span class="kt">reg</span> <span class="n">a</span><span class="p">;</span>
<span class="kt">reg</span> <span class="n">b</span><span class="p">;</span>
<span class="kt">reg</span> <span class="n">cin</span><span class="p">;</span>
<span class="kt">wire</span> <span class="n">s</span><span class="p">;</span>
<span class="kt">wire</span> <span class="n">cout</span><span class="p">;</span>

<span class="c1">// Instantiate full adder as dut (device under test)</span>

<span class="n">full_adder</span> <span class="n">dut</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">cout</span><span class="p">);</span>

<span class="c1">// Test vectors</span>
<span class="c1">// All combinations required </span>
<span class="k">initial</span>
 <span class="k">begin</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">#</span><span class="mi">100</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">#</span><span class="mi">100</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">#</span><span class="mi">100</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">#</span><span class="mi">100</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">#</span><span class="mi">100</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">#</span><span class="mi">100</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">#</span><span class="mi">100</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">#</span><span class="mi">100</span> <span class="p">$</span><span class="nb">finish</span><span class="p">;</span> <span class="c1">// exit the simulation</span>
 <span class="k">end</span>

<span class="c1">// Save results as VCD file </span>

<span class="k">initial</span>
 <span class="k">begin</span>
  <span class="p">$</span><span class="nb">dumpfile</span><span class="p">(</span><span class="s">"full_adder_tb_results.vcd"</span><span class="p">);</span>  <span class="c1">// Save simulation waveforms in this file</span>
  <span class="p">$</span><span class="nb">dumpvars</span><span class="p">;</span> <span class="c1">// Capture all simulation waveforms</span>
 <span class="k">end</span>

<span class="k">endmodule</span> 
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¸‹é¢, æˆ‘ä»¬éœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œç¼–è¯‘å·¥å…· <code class="language-plaintext highlighter-rouge">iverilog</code> å’Œæ³¢å½¢æŸ¥çœ‹å™¨ <code class="language-plaintext highlighter-rouge">GTKWave</code> å¯¹è®¾è®¡è¿›è¡Œæ£€éªŒ: (ç®€ä¾¿èµ·è§, æœ¬æ–‡ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">VSCode</code> çš„ <code class="language-plaintext highlighter-rouge">Verilog</code> æ³¢å½¢æ’ä»¶æŸ¥çœ‹æ³¢å½¢)</p>

<div class="language-verilog highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c1">// compile the file</span>
<span class="n">iverilog</span> <span class="o">-</span><span class="n">y</span><span class="p">.</span> <span class="o">-</span><span class="n">o</span> <span class="n">full_adder_output</span> <span class="n">full_adder_tb</span><span class="p">.</span><span class="n">v</span> <span class="n">full_adder</span><span class="p">.</span><span class="n">v</span>

<span class="c1">// dump the .vcd file to the directory</span>
<span class="n">vvp</span> <span class="n">full_adder_output</span>

<span class="c1">// use gtkwave to open the .vcd file</span>
<span class="n">gtkwave</span> <span class="n">full_adder_tb_results</span><span class="p">.</span><span class="n">vcd</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è§‚å¯Ÿæ–‡ä»¶å¤´çš„é—¨çº§å»¶è¿Ÿæ³¢å½¢, å¯çœ‹åˆ°æ˜æ˜¾å¼‚å¸¸: å®é™…ä¸Š <code class="language-plaintext highlighter-rouge">cout</code> ä¿¡å·çš„è®¡ç®—éœ€è¦ç»è¿‡ä¸‰é‡é€»è¾‘é—¨, å…¶å»¶è¿Ÿåº”è¯¥ä¸º <code class="language-plaintext highlighter-rouge">3ns</code>. è€Œé <code class="language-plaintext highlighter-rouge">2ns</code>:</p>

<p><img src="https://cdn.jsdelivr.net/gh/KirisameMarisaa/KirisameMarisaa.github.io/img/blogpost_images/20201105193827.png" alt="20201105193827" /></p>

<p>ç»è¿‡è®¨è®ºå’Œåˆ†æå¾—çŸ¥, Verilogå¯¹é€»è¾‘é—¨çš„æ¨¡æ‹Ÿæ˜¯åŸºäºé€»è¾‘è€Œéç”µè·¯çš„, å­˜åœ¨â€œçŸ­è·¯ç‰¹æ€§â€. åœ¨è¯¥ä¾‹ä¸­, ç”±äºè¾“å…¥ <code class="language-plaintext highlighter-rouge">c_in == 0</code>, äºŒçº§é€»è¾‘é—¨è¢«çŸ­è·¯, <code class="language-plaintext highlighter-rouge">cin_axorb</code> è¾“å‡ºå¿…ä¸º <code class="language-plaintext highlighter-rouge">0</code>, æ•…ä¸é—¨ä¸å†ç­‰å€™å…¶å¼‚æˆ–è¾“å‡ºè€Œç›´æ¥è¾“å‡ºç»“æœ, æ•…å®é™…å»¶è¿Ÿä»…ä¸º <code class="language-plaintext highlighter-rouge">2ns</code>.</p>

<p><br /></p>

<h2 id="4-ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨">$4$ ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨</h2>
<p>åŸºäºå…¨åŠ å™¨çš„è®¾è®¡, å¯ç®€å•å¼•ç”¨å…¨åŠ å™¨å°†å…¶è¿›è¡Œä¸²è”, å³å¯å¾—ä¸€ä¸ª $4$ ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨:</p>

<div class="language-verilog highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="c1">// 4-bit adder design using verilog primitive gates</span>


<span class="cp">`timescale</span> <span class="mi">1</span><span class="n">ns</span><span class="o">/</span><span class="mi">100</span><span class="n">ps</span>


<span class="cp">`default_nettype</span> <span class="n">none</span>

<span class="c1">//Module definition</span>

<span class="k">module</span> <span class="n">adder_4bit</span><span class="p">(</span><span class="kt">input</span>  <span class="kt">wire</span> <span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>  <span class="n">a</span><span class="p">,</span> 
                  <span class="kt">input</span>  <span class="kt">wire</span> <span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>  <span class="n">b</span><span class="p">,</span> 
                  <span class="kt">input</span>  <span class="kt">wire</span>        <span class="n">cin</span><span class="p">,</span> 
                  <span class="kt">output</span> <span class="kt">wire</span> <span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>  <span class="n">s</span><span class="p">,</span> 
                  <span class="kt">output</span> <span class="kt">wire</span>        <span class="n">cout</span><span class="p">);</span>


<span class="c1">//Internal carry connections</span>
<span class="kt">wire</span> <span class="n">c0</span><span class="p">;</span>    <span class="c1">// carry out bit 0 adder</span>
<span class="kt">wire</span> <span class="n">c1</span><span class="p">;</span>    <span class="c1">// carry out bit 1 adder</span>
<span class="kt">wire</span> <span class="n">c2</span><span class="p">;</span>    <span class="c1">// carry out bit 2 adder</span>

<span class="c1">// Instantiate 4 x full_adder</span>
<span class="n">full_adder</span> <span class="n">adder0</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cin</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c0</span><span class="p">);</span>
<span class="n">full_adder</span> <span class="n">adder1</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c0</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c1</span><span class="p">);</span>
<span class="n">full_adder</span> <span class="n">adder2</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c1</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c2</span><span class="p">);</span>
<span class="n">full_adder</span> <span class="n">adder3</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">c2</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">cout</span><span class="p">);</span>


<span class="k">endmodule</span> 

<span class="cp">`default_nettype</span> <span class="kt">wire</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>åœ¨æµ‹è¯•è¯¥è¡Œæ³¢è¿›ä½åŠ æ³•å™¨æ—¶, é™¤äº†è¿›è¡Œå…¨ç”µè·¯åˆå§‹åŒ–ä»¥åŠæµ‹è¯•æ‰€æœ‰çš„è¾“å…¥, è¾“å‡ºä»¥å¤–, è¿˜åº”æµ‹è¯•ä¸‰æ¡è¿æ¥å…¨åŠ å™¨çš„è¿›ä½å¯¼çº¿. æµ‹è¯•ä»£ç å¦‚ä¸‹:</p>

<div class="language-verilog highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
</pre></td><td class="rouge-code"><pre><span class="c1">// 4-bit adder testbench</span>


<span class="c1">// #1 = 1ns</span>
<span class="cp">`timescale</span> <span class="mi">1</span><span class="n">ns</span><span class="o">/</span><span class="mi">100</span><span class="n">ps</span> 

<span class="k">module</span> <span class="n">adder_4bit_tb</span><span class="p">();</span>

<span class="c1">// Internal connections</span>
<span class="kt">reg</span> <span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span> <span class="n">a</span><span class="p">;</span>
<span class="kt">reg</span> <span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span> <span class="n">b</span><span class="p">;</span>
<span class="kt">reg</span>       <span class="n">cin</span><span class="p">;</span>
<span class="kt">wire</span> <span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span> <span class="n">s</span><span class="p">;</span>
<span class="kt">wire</span> <span class="n">cout</span><span class="p">;</span>

<span class="c1">// Instantiate adder_4bit as dut (device under test)</span>

<span class="n">adder_4bit</span> <span class="n">dut</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">cout</span><span class="p">);</span>

<span class="c1">// Test vectors</span>
<span class="k">initial</span>
<span class="k">begin</span>
<span class="c1">// Using 14 test vectors the interconnect of the 4bit added can be verified</span>

<span class="c1">// Check all fulladders are connected to something, s=0 cout=0 not Xs</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Check connections for a[0], b[0], cin, S[0], S=0001 cout=0</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0001</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0001</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="c1">// Check connection of carry out of the first adder</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0001</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0001</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Check connections for a[1], b[1], c[1]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0010</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0010</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// Check connection of carry out of the second adder</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0010</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0010</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Check connections for a[2], b[2], c[2]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0100</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0100</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// Check connection of carry out of the third adder</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0100</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0100</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Check connections for a[3], b[3], c[3]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b1000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b1000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">// Check connection of carry out of the fourth adder</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b1000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b1000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>




<span class="c1">// Connectivity tests completed.</span>

<span class="c1">// ADD TESTS FOR FINDING MAXIMUM CARRY DELAY </span>
<span class="c1">// the critical path</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mb">'b1111</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mb">'b0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="c1">// it should be 9 ns</span>


<span class="p">#</span><span class="mi">100</span> <span class="p">$</span><span class="nb">finish</span><span class="p">;</span> <span class="c1">// exit the simulation</span>
<span class="k">end</span>
 
 
<span class="c1">// Save results as VCD file </span>
<span class="k">initial</span>
 <span class="k">begin</span>
  <span class="p">$</span><span class="nb">dumpfile</span><span class="p">(</span><span class="s">"adder_4bit_tb_results.vcd"</span><span class="p">);</span>  <span class="c1">// Save simulation waveforms in this file</span>
  <span class="p">$</span><span class="nb">dumpvars</span><span class="p">;</span> <span class="c1">// Capture all simulation waveforms</span>
 <span class="k">end</span>

<span class="k">endmodule</span> 
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¸‹é¢ç®€å•è®¨è®º $4$ ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨çš„æœ€å¤§å»¶è¿Ÿé—®é¢˜: 
æ ¹æ®å‰æ–‡æ‰€è¿°, æ˜“å¾—å½“ä¸”ä»…å½“å‚ä¸è®¡ç®—çš„æ•°çš„æ¯ä¸€ä½éƒ½éœ€è¦è¿›ä½æ—¶, æ‰å¯èƒ½å‘ç”Ÿæœ€å¤§å»¶è¿Ÿ; è€Œç”±äºç»„æˆè¡Œæ³¢è¿›ä½åŠ æ³•å™¨çš„å…¨åŠ å™¨è¾“å‡ºå»¶è¿Ÿçš„çŸ­è·¯ç‰¹æ€§, è¦æƒ³ä½¿æœ€å¤§å»¶è¿Ÿå‡ºç°, å¿…é¡»ç¡®ä¿æ¯ä¸€ä¸ªå…¨åŠ å™¨æ¨¡ç»„çš„ä¸¤ä¸ªè¾“å…¥ä¿¡å· <code class="language-plaintext highlighter-rouge">a_i</code>, <code class="language-plaintext highlighter-rouge">b_i</code> å¼‚æˆ–è¿ç®—åå€¼ä¸º $1$, ä¸” <code class="language-plaintext highlighter-rouge">cin_i == 1</code>. 
åœ¨è¯¥æƒ…å½¢ä¸‹:</p>
<ol>
  <li>ç»è¿‡1ns, å…¨éƒ¨çš„å››ä¸ªå…¨åŠ å™¨å®Œæˆäº†å¯¹ <code class="language-plaintext highlighter-rouge">a_i, b_i</code> çš„å¼‚æˆ–è¿ç®—, å¹¶ç­‰å¾… <code class="language-plaintext highlighter-rouge">c_in_i</code> è¾“å…¥:</li>
  <li>ä»æœ€ä½ä½è¿›ä½åˆ°æœ€é«˜ä½, æ¯ä¸€ä½çš„è¿›ä½è®¡ç®—å»¶è¿Ÿå‡ä¸º <code class="language-plaintext highlighter-rouge">2ns</code>; å…±æœ‰ <code class="language-plaintext highlighter-rouge">2*4 = 8 ns</code>:</li>
  <li>æœ€ç»ˆå®Œæˆè¾“å‡º, æ€»è€—æ—¶ä¸º <code class="language-plaintext highlighter-rouge">9ns</code>.</li>
</ol>

<p><br /></p>

<h2 id="16-ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨">$16$ ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨</h2>
<p>å’Œ $4$ ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨ç±»ä¼¼, $16$ ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨æ˜¯å››ä¸ª $4$ ä½è¡Œæ³¢è¿›ä½åŠ æ³•å™¨çš„ç®€å•ç»„åˆ, å…·ä½“å®ç°æ–¹å¼ä¸å†èµ˜è¿°. ç›¸å…³å®ç°ä»£ç å’Œæµ‹è¯•ä»£ç å¦‚ä¸‹:</p>

<div class="language-verilog highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="c1">// 16-bit adder design using verilog primitive gates</span>

<span class="cp">`timescale</span> <span class="mi">1</span><span class="n">ns</span><span class="o">/</span><span class="mi">100</span><span class="n">ps</span>

<span class="cp">`default_nettype</span> <span class="n">none</span>

<span class="k">module</span> <span class="n">adder_16bit</span><span class="p">(</span><span class="kt">input</span>  <span class="kt">wire</span> <span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>  <span class="n">a</span><span class="p">,</span> 
                   <span class="kt">input</span>  <span class="kt">wire</span> <span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>  <span class="n">b</span><span class="p">,</span> 
                   <span class="kt">input</span>  <span class="kt">wire</span>         <span class="n">cin</span><span class="p">,</span> 
                   <span class="kt">output</span> <span class="kt">wire</span> <span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>  <span class="n">s</span><span class="p">,</span> 
                   <span class="kt">output</span> <span class="kt">wire</span>         <span class="n">cout</span><span class="p">);</span>

<span class="c1">//Internal carry connections</span>
<span class="kt">wire</span> <span class="n">c0</span><span class="p">;</span>    <span class="c1">// carry out bit 0 adder</span>
<span class="kt">wire</span> <span class="n">c1</span><span class="p">;</span>    <span class="c1">// carry out bit 1 adder</span>
<span class="kt">wire</span> <span class="n">c2</span><span class="p">;</span>    <span class="c1">// carry out bit 2 adder</span>
<span class="kt">wire</span> <span class="n">c3</span><span class="p">;</span>    <span class="c1">// carry out bit 3 adder</span>


<span class="c1">// Instantiate 4 x adder_4bit</span>
<span class="n">adder_4bit</span> <span class="n">adder0</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">],</span> <span class="n">cin</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">],</span> <span class="n">c0</span><span class="p">);</span>
<span class="n">adder_4bit</span> <span class="n">adder1</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">7</span><span class="o">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">7</span><span class="o">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">c0</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="o">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">c1</span><span class="p">);</span>
<span class="n">adder_4bit</span> <span class="n">adder2</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">c1</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">11</span><span class="o">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">c2</span><span class="p">);</span>
<span class="n">adder_4bit</span> <span class="n">adder3</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">12</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">12</span><span class="p">],</span> <span class="n">c2</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">12</span><span class="p">],</span> <span class="n">cout</span><span class="p">);</span>



<span class="k">endmodule</span> 

<span class="cp">`default_nettype</span> <span class="kt">wire</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æµ‹è¯•:</p>

<div class="language-verilog highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
</pre></td><td class="rouge-code"><pre><span class="c1">// 16-bit adder testbench</span>

<span class="c1">// #1 = 1ns</span>
<span class="cp">`timescale</span> <span class="mi">1</span><span class="n">ns</span><span class="o">/</span><span class="mi">100</span><span class="n">ps</span> 

<span class="k">module</span> <span class="n">adder_16bit_tb</span><span class="p">();</span>

<span class="c1">// Internal connections</span>
<span class="kt">reg</span> <span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>  <span class="n">a</span><span class="p">;</span>
<span class="kt">reg</span> <span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span>  <span class="n">b</span><span class="p">;</span>
<span class="kt">reg</span>         <span class="n">cin</span><span class="p">;</span>
<span class="kt">wire</span> <span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span> <span class="n">s</span><span class="p">;</span>
<span class="kt">wire</span>        <span class="n">cout</span><span class="p">;</span>

<span class="c1">// Instantiate adder_16bit as dut (device under test)</span>

<span class="n">adder_16bit</span> <span class="n">dut</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">cout</span><span class="p">);</span>

<span class="c1">// Test vectors</span>
<span class="k">initial</span>
<span class="k">begin</span>
<span class="c1">// 38 test vectors required for connectivity tests</span>
<span class="c1">// Check all adders are connected to something, S=0 cout=0 not Xs</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="c1">//Check connections for A[0], B[0], Cin, S[0], S=0001 cout=0</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0001</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0001</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="c1">//Check connections for  A[1], B[1], S[1]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0002</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0002</span><span class="p">;</span>
<span class="c1">//Check connections for  A[2], B[2], S[2]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0004</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0004</span><span class="p">;</span>
<span class="c1">//Check connections for  A[3], B[3], S[3]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0008</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0008</span><span class="p">;</span>
<span class="c1">//Check connection of carry out of the first 4bit adder in to 2nd 4-bit adder</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0008</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0008</span><span class="p">;</span>


<span class="c1">// Check the second 4-bit adder</span>
<span class="c1">//Check connections for A[0], B[0], S[0]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0010</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0010</span><span class="p">;</span>
<span class="c1">//Check connections for  A[1], B[1], S[1]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0020</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0020</span><span class="p">;</span>
<span class="c1">//Check connections for  A[2], B[2], S[2]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0040</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0040</span><span class="p">;</span>
<span class="c1">//Check connections for  A[3], B[3], S[3]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0080</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0080</span><span class="p">;</span>
<span class="c1">//Check connection of carry out of the 2nd 4bit adder in to 3rd 4-bit adder</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0080</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0080</span><span class="p">;</span>

<span class="c1">// Check the third 4-bit adder</span>
<span class="c1">//Check connections for A[0], B[0], S[0]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0100</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0100</span><span class="p">;</span>
<span class="c1">//Check connections for  A[1], B[1], S[1]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0200</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0200</span><span class="p">;</span>
<span class="c1">//Check connections for  A[2], B[2], S[2]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0400</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0400</span><span class="p">;</span>
<span class="c1">//Check connections for  A[3], B[3], S[3]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0800</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0800</span><span class="p">;</span>
<span class="c1">//Check connection of carry out of the 3rd 4bit adder in to 4th 4-bit adder</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0800</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0800</span><span class="p">;</span>

<span class="c1">// Check the fourth 4-bit adder</span>
<span class="c1">//Check connections for A[0], B[0], S[0]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h1000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h1000</span><span class="p">;</span>
<span class="c1">//Check connections for  A[1], B[1], S[1]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h2000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h2000</span><span class="p">;</span>
<span class="c1">//Check connections for  A[2], B[2], S[2]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h4000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h4000</span><span class="p">;</span>
<span class="c1">//Check connections for  A[3], B[3], S[3]</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h8000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h8000</span><span class="p">;</span>
<span class="c1">//Check connection of carry out of the 4th 4bit adder in to cout</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h8000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h8000</span><span class="p">;</span>


<span class="c1">// Connectivity tests completed.</span>

<span class="c1">// ADD TESTS FOR FINDING MAXIMUM CARRY DELAY</span>
<span class="c1">// the critical path</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">#</span><span class="mi">100</span> <span class="n">a</span><span class="o">=</span><span class="mh">16'hFFFF</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="mh">16'h0000</span><span class="p">;</span> <span class="n">cin</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="c1">// it should be 33 ns</span>

<span class="p">#</span><span class="mi">100</span> <span class="p">$</span><span class="nb">finish</span><span class="p">;</span>
<span class="k">end</span>
 
 
<span class="c1">// Save results as VCD file </span>
<span class="k">initial</span>
 <span class="k">begin</span>
  <span class="p">$</span><span class="nb">dumpfile</span><span class="p">(</span><span class="s">"adder_16bit_tb_results.vcd"</span><span class="p">);</span>  <span class="c1">// Save simulation waveforms in this file</span>
  <span class="p">$</span><span class="nb">dumpvars</span><span class="p">;</span> <span class="c1">// Capture all simulation waveforms</span>
 <span class="k">end</span>

<span class="k">endmodule</span> 
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¾ç…§ç±»ä¼¼çš„åˆ†ææµç¨‹, ä¸éš¾å¾—å‡ºå…¶æœ€å¤§é—¨çº§å»¶è¿Ÿä¸º <code class="language-plaintext highlighter-rouge">1 + 4*8 = 32ns</code>.</p>

<p><br /></p>

<h2 id="è¶…å‰è¿›ä½åŠ æ³•å™¨">è¶…å‰è¿›ä½åŠ æ³•å™¨</h2>
<p>è¡Œæ³¢è¿›ä½åŠ æ³•å™¨ç»“æ„ç®€å•, å®ç°ä¾¿åˆ©. ä½†æ˜¾è€Œæ˜“è§, å…¶æœ€å¤§é—¨çº§å»¶è¿Ÿå°†éšç€è¢«è®¡ç®—æ•°ä½æ•°çš„å¢é•¿è€Œå¢é•¿. ä¸ºäº†è§„é¿è¿™ä¸€é—®é¢˜, åˆè®¾è®¡äº†è¶…å‰è¿›ä½åŠ æ³•å™¨:</p>

<p>è¶…å‰è¿›ä½åŠ æ³•å™¨ (<code class="language-plaintext highlighter-rouge">Carry-Look Ahead Adder</code>) æ˜¯ä¸€ç§é«˜é€ŸåŠ æ³•å™¨, æ¯ä¸€ä¸ªè¿ç®—ä½çš„å€¼éƒ½ç”±ä¸€ç»„ç‰¹å®šç”µè·¯åŒæ—¶ç”Ÿæˆ, è€Œæ— éœ€ç­‰å¾…ä¸Šä¸€ä½çš„è¿ç®—ç»“æœå®Œæˆ, æ¯ä¸ªå…¨åŠ å™¨çš„è¿›ä½è¾“å…¥å¹¶ä¸æ¥è‡ªå‰ä¸€çº§çš„å…¨åŠ å™¨è¿ç®—ç»“æœ, è€Œæ˜¯ç”±è¶…å‰è¿›ä½çš„é€»è¾‘æ‰€ç¡®å®š. å…¶é€»è¾‘åŸç†å¦‚ä¸‹:</p>

<p>ä¸å¤±ä¸€èˆ¬æ€§, è€ƒè™‘ä¸€ä¸ªå•ä½çš„å«è¿›ä½äºŒè¿›åˆ¶åŠ æ³•: $A_i + B_i , C_i$. ç”±çœŸå€¼è¡¨å¯å¾—:</p>

\[C_{i+1} = B_i\cdot C_i + A_i\cdot C_i + B_i\cdot A_i = A_i \cdot B_i + (A_i + B_i)\cdot C_i\]

<p>å®šä¹‰:</p>

\[G_i = A_i\cdot B_i, ~~~ P_i = A_i + B_i\]

<p>æ•…é€’æ¨å¼åŒ–ä¸º:</p>

\[C_{i+1} = G_i + P_i \cdot C_i\]

<p>å› æ­¤, é€’æ¨å…³ç³»å¯æ•´ç†å¦‚ä¸‹:</p>

\[C_i = \begin{cases} ~G_i ~~~~~~~~~~~~~~~~~~~~~~ i = 0 \\\ G_i + P_i \cdot C_i ~~~~~~ i \geqslant 1 \end{cases} ~~~~~~while~~~~~~  \begin{cases} ~G_i = A_i \cdot B_i \\\ P_i = A_i + B_i \end{cases}\]

<p>ä»¥ä¸€ä¸ª $4$ ä½è¶…å‰è¿›ä½åŠ æ³•å™¨ä¸ºä¾‹, å…¶è¾“å‡ºå¯è¡¨ç¤ºä¸º:</p>

\[C_4 = G_3 + P_3 \cdot G_2 + P_3 \cdot P_2 \cdot G_1 + P_3 \cdot P_2 \cdot P_1 \cdot G_0 + 
P_3 \cdot P_2 \cdot P_1 \cdot P_0 \cdot C_0\]

<p><img src="https://cdn.jsdelivr.net/gh/KirisameMarisaa/KirisameMarisaa.github.io/img/blogpost_images/20201105193909.png" alt="20201105193909" /></p>

<p>å¯è§, è¶…å‰è¿›ä½åŠ æ³•å™¨è™½ç„¶è®¡ç®— $C_{i+1}$ çš„å»¶è¿Ÿæ’ä¸ºä¸‰çº§é—¨å»¶è¿Ÿ, ä¸åŠ æ³•å™¨çš„ä½æ•°æ— å…³, ä½†ä»£ä»·æ˜¯éšç€åŠ æ³•å™¨ä½æ•°çš„å¢åŠ , å…¶ç”µè·¯å¤æ‚åº¦ä¹Ÿéšä¹‹å¢åŠ .</p>

<p>å› æ­¤, åœ¨å®é™…ç”µè·¯è®¾è®¡ä¸­, å¸¸å¸¸é‡‡å–æŠ˜ä¸­çš„è§£å†³æ–¹æ¡ˆ: é‰´äºè¡Œæ³¢è¿›ä½åŠ æ³•å™¨ä»¥å¤æ‚åº¦æ¢æ•ˆç‡, è¶…å‰è¿›ä½åŠ æ³•å™¨ä»¥æ•ˆç‡æ¢å¤æ‚åº¦, æˆ‘ä»¬é‡‡ç”¨å¤šä¸ªå°è§„æ¨¡çš„è¶…å‰è¿›ä½åŠ æ³•å™¨ä¸²è”æ‹¼æ¥, å½¢æˆä¸€ä¸ªä½æ•°è¾ƒå¤šçš„å¤§åŠ æ³•å™¨, å¦‚ç”¨ $4$ ä¸ª $8$-bit çš„è¶…å‰è¿›ä½åŠ æ³•å™¨è¿æ¥æˆä¸€ä¸ª $32$-bit çš„åŠ æ³•å™¨.</p>
:ET