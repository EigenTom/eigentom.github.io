I"‰<h1 id="ch1-åŸºç¡€">Ch1 åŸºç¡€</h1>

<p>åœ¨æœ¬ç« ä¸­, æˆ‘ä»¬å°†å­¦ä¹ åœ¨éšåçš„ç« èŠ‚ä¸­ç”¨äºå®ç°, åˆ†æå’Œæ¯”è¾ƒç®—æ³•çš„åŸºæœ¬åŸåˆ™ä¸æ–¹æ³•. æœ¬ä¹¦ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">Java</code> ç¼–ç¨‹, æ•…åœ¨ç¬¬ä¸€ç« ä¸­æ¶‰åŠäº†è¯¸å¤šå…³äº <code class="language-plaintext highlighter-rouge">Java</code> è¯­è¨€çš„åŸºæœ¬è¯­æ³•å’Œé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„æ¦‚å¿µ. é™¤æ­¤ä¹‹å¤–,  <strong>èƒŒåŒ…, é˜Ÿåˆ—å’Œæ ˆ</strong> è¿™ä¸‰ç§åŸºç¡€çš„ <strong>æŠ½è±¡æ•°æ®ç±»å‹</strong> ä¹Ÿåœ¨è¯¥ç« èŠ‚ä¸­è¢«ä»‹ç». æœ€å, æœ¬ç« ä»‹ç»äº†ä¸€äº›åˆ†æç®—æ³•æ€§èƒ½çš„æ–¹æ³•, å¹¶é€šè¿‡å¯¹è¿é€šæ€§é—®é¢˜è§£æ³•çš„è®¨è®ºå¼•å‡ºäº† <strong>å¹¶æŸ¥é›†</strong> è¿™ä¸ªæ•°æ®ç»“æ„çš„å®ç°.</p>

<p><br /></p>

<h2 id="11-java-ç¨‹åºè®¾è®¡æ¨¡å‹å’Œé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡">1.1 <code class="language-plaintext highlighter-rouge">Java</code> ç¨‹åºè®¾è®¡æ¨¡å‹å’Œé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡</h2>

<p>æˆ‘ä»¬é¦–å…ˆå›é¡¾ä¸€äº›é‡è¦çš„ <code class="language-plaintext highlighter-rouge">Java</code> è¯­è¨€ç‰¹æ€§å’Œ <code class="language-plaintext highlighter-rouge">OOP</code> æ¦‚å¿µ.</p>

<p><strong>å®šä¹‰</strong>: æ•°æ®ç±»å‹å’ŒæŠ½è±¡æ•°æ®ç±»å‹</p>

<blockquote>
  <p>æ•°æ®ç±»å‹æŒ‡çš„æ˜¯ <strong>ä¸€ç»„å€¼</strong> å’Œ <strong>ä¸€ç»„å¯¹è¿™äº›å€¼çš„æ“ä½œçš„é›†åˆ</strong>, è€Œ <code class="language-plaintext highlighter-rouge">Java</code> ç¨‹åºè®¾è®¡çš„åŸºç¡€æ˜¯ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">class</code> å…³é”®å­—æ„é€ ç§°ä¸º <strong>å¼•ç”¨ç±»å‹</strong> çš„æ•°æ®ç±»å‹.</p>
</blockquote>

<p>è¦ä½¿ç”¨ä¸€ç§æ•°æ®ç±»å‹, æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“å®ƒæ˜¯å¦‚ä½•å®ç°çš„. å¦‚æœæˆ‘ä»¬å°†ä¸€ç§æ•°æ®ç±»å‹çš„æ•°æ®è¡¨ç¤ºæ–¹å¼ <strong>éšè—</strong> èµ·æ¥, é‚£ä¹ˆè¿™æ ·çš„æ•°æ®ç±»å‹å°±è¢«ç§°ä¸º <strong>æŠ½è±¡æ•°æ®ç±»å‹</strong>. åœ¨å®ç°æŠ½è±¡æ•°æ®ç±»å‹æ—¶, æˆ‘ä»¬åªéœ€è¦å°†æ³¨æ„åŠ›é›†ä¸­åœ¨å®ƒçš„ <code class="language-plaintext highlighter-rouge">API</code> æ‰€æè¿°çš„æ“ä½œä¸Šè€Œæ— éœ€å…³æ³¨å…·ä½“çš„ç»†èŠ‚.</p>

<p><code class="language-plaintext highlighter-rouge">API</code> å¸¸è¢«ç”¨æ¥æè¿° <strong>æŠ½è±¡æ•°æ®ç±»å‹</strong> çš„è¡Œä¸º. å…¶ä½œç”¨æ˜¯åˆ—å‡ºè¯¥æ•°æ®ç±»å‹çš„æ‰€æœ‰ <strong>æ„é€ å‡½æ•°</strong> å’Œ <strong>å®ä¾‹æ–¹æ³•</strong>.</p>

<p><br /></p>

<p><strong>å®šä¹‰</strong>: å¯¹è±¡</p>

<blockquote>
  <p>å¯¹è±¡æ˜¯ <strong>èƒ½å¤Ÿæ‰¿è½½æ•°æ®ç±»å‹çš„å€¼</strong>çš„å®ä½“. <code class="language-plaintext highlighter-rouge">Java</code> ä¸­æ‰€æœ‰å¯¹è±¡å‡å…·å¤‡ä¸‰ä¸ªç‰¹æ€§: <strong>çŠ¶æ€</strong>, å³æ•°æ®ç±»å‹ä¸­çš„å€¼; <strong>æ ‡è¯†</strong>, ç”¨äºå°†å¯¹è±¡åŠ ä»¥åŒºåˆ†; <strong>è¡Œä¸º</strong>, äº¦å³æ•°æ®ç±»å‹çš„æ“ä½œ.</p>
</blockquote>

<p><br /></p>

<p>è¦å®Œå…¨äº†è§£ä¸€ä¸ªæ•°æ®ç±»å‹, æˆ‘ä»¬å°±éœ€è¦å®ƒçš„ <strong>API</strong>, <strong>å…¸å‹ç”¨ä¾‹</strong> å’Œ <strong>å®ç°</strong>. ä¸ºäº†è¾¾æˆç”¨ä¾‹å’Œå®ç°çš„åˆ†ç¦», æˆ‘ä»¬å¯ä»¥å°†ç”¨ä¾‹ç‹¬ç«‹æˆå«æœ‰ä¸€ä¸ªé™æ€æ–¹æ³• <code class="language-plaintext highlighter-rouge">main()</code> çš„ç±», å¹¶å°†æ•°æ®ç±»å‹å®šä¹‰ä¸­çš„ <code class="language-plaintext highlighter-rouge">main()</code> æ–¹æ³•é¢„ç•™ä¸ºä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹. åŒæ ·çš„, åœ¨å¼€å‘æ•°æ®ç±»å‹æ—¶, æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸‹åˆ—çš„é¡ºåºä½¿ç”¨ <strong>æŠ½è±¡æ•°æ®ç±»å‹</strong> æ»¡è¶³ç”¨ä¾‹çš„éœ€æ±‚:</p>

<ol>
  <li>å®šä¹‰ä¸€ä»½ <code class="language-plaintext highlighter-rouge">API</code> å®ç°ç¼–ç¨‹çš„æ¨¡å—åŒ–.</li>
  <li>ç¼–å†™ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">Java</code> ç±»å®ç° <code class="language-plaintext highlighter-rouge">API</code> çš„å®šä¹‰.</li>
  <li>å®ç°å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ç”¨äºéªŒè¯å‰ä¸¤æ­¥çš„è®¾è®¡å’Œå®Œæˆæƒ…å†µ.</li>
</ol>

<p>é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„ä¸€å¤§ç‰¹å¾æ˜¯ <strong>ä½¿ç”¨æ•°æ®ç±»å‹çš„å®ç°å°è£…æ•°æ®</strong>. å°è£…ä½¿æˆ‘ä»¬å¯ä»¥ç‹¬ç«‹å¼€å‘ <strong>ç”¨ä¾‹</strong> å’Œ <strong>å®ç°</strong> çš„ä»£ç , å¹¶ä¸”ç¡®ä¿å³ä½¿ä»¥å <strong>å®ç°</strong> éƒ¨åˆ†çš„ä»£ç è¢«æ›¿æ¢æˆæ”¹è¿›çš„ç‰ˆæœ¬, <strong>ç”¨ä¾‹</strong> éƒ¨åˆ†ä¹Ÿä¸ä¼šå—åˆ°å½±å“. åœ¨å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•æ—¶, å€˜è‹¥å¼€å‘å‡ºæ›´å¥½çš„ç®—æ³•, åªéœ€è¦ç”¨æŠ½è±¡æ•°æ®ç±»å‹çš„, æ”¹è¿›çš„å®ç°æ›¿æ¢åŸæœ‰çš„æ—§å®ç°, å°±å¯ä»¥ä¿è¯åœ¨ä¸æ”¹å˜ä»»ä½•ç”¨ä¾‹ä»£ç çš„å‰æä¸‹æ”¹å–„æ‰€æœ‰è¿™äº›ç”¨ä¾‹çš„æ€§èƒ½.</p>

<p><strong>å®šä¹‰</strong>: æ¥å£å’Œå­ç±»</p>

<blockquote>
  <p><strong>æ¥å£</strong> è§„å®šäº†ä¸€ç³»åˆ—éœ€è¦å®ç°çš„æ–¹æ³•, å®ƒå¯ä»¥ä½¿ä¸¤ä¸ªå®ç°äº†è¿™äº›å…¬å…±æ–¹æ³•çš„, åŸæœ¬æ²¡æœ‰å…³è”çš„ç±»ä¹‹é—´å»ºç«‹è”ç³».  <strong>å­ç±»</strong> å…è®¸æˆ‘ä»¬åœ¨ä¸é‡å†™æ•´ä¸ªç±»çš„å‰æä¸‹å°±èƒ½æ”¹å˜å®ƒçš„è¡Œä¸ºæˆ–è€…æ·»åŠ æ–°çš„åŠŸèƒ½, å…¶ä¸»è¦æ€æƒ³æ˜¯å®šä¹‰ä¸€ä¸ªæ–°ç±»æ¥ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰ <strong>å®ä¾‹æ–¹æ³•å’Œå®ä¾‹å˜é‡</strong>, å…¶ä¸­å­ç±»å¯ä»¥åŒ…å«æ¯”çˆ¶ç±»æ›´å¤šçš„æ–¹æ³•, ä¹Ÿå¯ä»¥å¯¹çˆ¶ç±»ä¸­åŸæœ‰çš„æ–¹æ³•è¿›è¡Œé‡å®šä¹‰.</p>
</blockquote>

<p><br /></p>

<h2 id="12-åŸºç¡€æŠ½è±¡æ•°æ®ç±»å‹-èƒŒåŒ…-é˜Ÿåˆ—å’Œæ ˆ">1.2 åŸºç¡€æŠ½è±¡æ•°æ®ç±»å‹: èƒŒåŒ…, é˜Ÿåˆ—å’Œæ ˆ</h2>

<p><strong>èƒŒåŒ…</strong>, <strong>é˜Ÿåˆ—</strong> å’Œ <strong>æ ˆ</strong> çš„ä¸åŒä¹‹å¤„åªåœ¨äºå…¶åˆ é™¤æˆ–è®¿é—®å¯¹è±¡çš„é¡ºåº. æˆ‘ä»¬é¦–å…ˆä»‹ç»è¿™ä¸‰ç§æ•°æ®ç»“æ„çš„ <code class="language-plaintext highlighter-rouge">API</code>:</p>

<ol>
  <li>
    <p>èƒŒåŒ…</p>

    <table>
      <thead>
        <tr>
          <th><code class="language-plaintext highlighter-rouge">public class</code></th>
          <th><code class="language-plaintext highlighter-rouge">Bag&lt;Item&gt;</code></th>
          <th><code class="language-plaintext highlighter-rouge">implements Iterable&lt;Item&gt;</code></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Â </td>
          <td><code class="language-plaintext highlighter-rouge">Bag()</code></td>
          <td>åˆ›å»ºä¸€ä¸ªç©ºèƒŒåŒ…</td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">void</code></td>
          <td><code class="language-plaintext highlighter-rouge">add(Item item)</code></td>
          <td>æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ </td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">boolean</code></td>
          <td><code class="language-plaintext highlighter-rouge">isEmpty()</code></td>
          <td>æ£€æŸ¥æ˜¯å¦ä¸ºç©º</td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">int</code></td>
          <td><code class="language-plaintext highlighter-rouge">size()</code></td>
          <td>å…ƒç´ æ•°é‡</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>é˜Ÿåˆ—  (å…ˆè¿›å…ˆå‡º)</p>

    <table>
      <thead>
        <tr>
          <th><code class="language-plaintext highlighter-rouge">public class</code></th>
          <th><code class="language-plaintext highlighter-rouge">Queue&lt;Item&gt;</code></th>
          <th><code class="language-plaintext highlighter-rouge">implements Iterable&lt;Item&gt;</code></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Â </td>
          <td><code class="language-plaintext highlighter-rouge">Queue()</code></td>
          <td>åˆ›å»ºä¸€ä¸ªç©ºé˜Ÿåˆ—</td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">void</code></td>
          <td><code class="language-plaintext highlighter-rouge">enqueue(Item item)</code></td>
          <td>æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ </td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">Item</code></td>
          <td><code class="language-plaintext highlighter-rouge">dequeue()</code></td>
          <td>åˆ é™¤æœ€è¿‘æ·»åŠ çš„å…ƒç´ </td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">boolean</code></td>
          <td><code class="language-plaintext highlighter-rouge">isEmpty()</code></td>
          <td>æ£€æŸ¥æ˜¯å¦ä¸ºç©º</td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">int</code></td>
          <td><code class="language-plaintext highlighter-rouge">size()</code></td>
          <td>å…ƒç´ æ•°é‡</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>æ ˆ (åè¿›å…ˆå‡º, ä¸‹å‹æ ˆ)</p>

    <table>
      <thead>
        <tr>
          <th><code class="language-plaintext highlighter-rouge">public class</code></th>
          <th><code class="language-plaintext highlighter-rouge">Stack&lt;Item&gt;</code></th>
          <th><code class="language-plaintext highlighter-rouge">implements Iterable&lt;Item&gt;</code></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Â </td>
          <td><code class="language-plaintext highlighter-rouge">Stack()</code></td>
          <td>åˆ›å»ºä¸€ä¸ªç©ºæ ˆ</td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">void</code></td>
          <td><code class="language-plaintext highlighter-rouge">push(Item item)</code></td>
          <td>æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ </td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">Item</code></td>
          <td><code class="language-plaintext highlighter-rouge">pop()</code></td>
          <td>åˆ é™¤æœ€è¿‘æ·»åŠ çš„å…ƒç´ </td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">boolean</code></td>
          <td><code class="language-plaintext highlighter-rouge">isEmpty()</code></td>
          <td>æ£€æŸ¥æ˜¯å¦ä¸ºç©º</td>
        </tr>
        <tr>
          <td><code class="language-plaintext highlighter-rouge">int</code></td>
          <td><code class="language-plaintext highlighter-rouge">size()</code></td>
          <td>å…ƒç´ æ•°é‡</td>
        </tr>
      </tbody>
    </table>
  </li>
</ol>

<p>ä¸‹é¢åˆ†åˆ«ä»‹ç»ä¸‰ç§æ•°æ®ç±»å‹.</p>

<h3 id="èƒŒåŒ…">èƒŒåŒ…</h3>

<p>èƒŒåŒ…æ˜¯ä¸€ç§ <strong>ä¸æ”¯æŒä»ä¸­åˆ é™¤å…ƒç´ </strong> çš„ <strong>é›†åˆæ•°æ®ç±»å‹</strong>, å…¶ä½œç”¨æ˜¯å¸®åŠ©ç”¨ä¾‹æ”¶é›†å¹¶è¿­ä»£éå†æ‰€æœ‰æ”¶é›†åˆ°çš„å…ƒç´ , å¹¶ä¸” <strong>è¿­ä»£çš„é¡ºåºä¸ç¡®å®š</strong>ä¸”ä¸ç”¨ä¾‹æ— å…³.</p>

<h3 id="é˜Ÿåˆ—-å…ˆè¿›å…ˆå‡º">é˜Ÿåˆ— (å…ˆè¿›å…ˆå‡º)</h3>

<p>å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—, æˆ–ç®€ç§°é˜Ÿåˆ—, æ˜¯ä¸€ç§åŸºäºå…ˆè¿›å…ˆå‡º (<code class="language-plaintext highlighter-rouge">FIFO</code>) ç­–ç•¥çš„é›†åˆç±»å‹. åœ¨ç”¨ä¾‹ä½¿ç”¨é«˜çº§å¾ªç¯è¯­å¥ <code class="language-plaintext highlighter-rouge">foreach</code> è¿­ä»£è®¿é—®é˜Ÿåˆ—çš„å…ƒç´ æ—¶, å…ƒç´ è¢«å¤„ç†çš„é¡ºåºå°±æ˜¯ <strong>å®ƒä»¬è¢«æ·»åŠ è¿›é˜Ÿåˆ—ä¸­</strong> çš„é¡ºåº. é€šè¿‡åœ¨ç¨‹åºä¸­ä½¿ç”¨é˜Ÿåˆ—æ•°æ®ç»“æ„, æˆ‘ä»¬å¯ä»¥åœ¨é›†åˆä¿å­˜å…ƒç´ çš„åŒæ—¶ <strong>ä¿å­˜å®ƒä»¬çš„ç›¸å¯¹é¡ºåº</strong>.</p>

<h3 id="ä¸‹å‹æ ˆ">ä¸‹å‹æ ˆ</h3>

<p>ä¸‹å‹æ ˆ, æˆ–ç®€ç§°æ ˆ, æ˜¯ä¸€ç§åŸºäºåè¿›å…ˆå‡º (<code class="language-plaintext highlighter-rouge">LIFO</code>) ç­–ç•¥çš„é›†åˆç±»å‹. å’Œé˜Ÿåˆ—ä¸åŒ, å½“ç”¨ä¾‹ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">foreach</code> è¿­ä»£éå†æ ˆä¸­å…ƒç´ æ—¶, å…ƒç´ çš„å¤„ç†é¡ºåºæ°å¥½ä¸å®ƒä»¬è¢«å‹å…¥çš„é¡ºåºç›¸å. é€šè¿‡åœ¨ç¨‹åºä¸­ä½¿ç”¨é˜Ÿåˆ—æ•°æ®ç»“æ„, æˆ‘ä»¬å¯ä»¥åœ¨ç”¨é›†åˆä¿å­˜å…ƒç´ çš„åŒæ—¶ <strong>é¢ å€’ä¿å­˜å®ƒä»¬çš„ç›¸å¯¹é¡ºåº</strong>.</p>

<p><br /></p>

<p>ä¸‹é¢è®¨è®ºå¯¹ä¸Šè¿°ä¸‰ç§æ•°æ®ç±»å‹çš„å®ç°. é¦–å…ˆè€ƒè™‘ä¸€ç§å®¹é‡å›ºå®šçš„æŠ½è±¡æ•°æ®ç±»å‹: <strong>å®šå®¹æ ˆ</strong>:</p>

<p>å®šå®¹æ ˆåªèƒ½å¤„ç† <code class="language-plaintext highlighter-rouge">String</code>, ä¸æ”¯æŒè¿­ä»£å¹¶ä¸”è¦æ±‚ç”¨ä¾‹æŒ‡å®šä¸€ä¸ªå®¹é‡. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong><code class="language-plaintext highlighter-rouge">String</code>æ•°ç»„</strong> ä½œä¸ºå®šå®¹æ ˆçš„æ•°æ®è¡¨ç¤ºæ–¹å¼:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FixedCapacityStackOfStrings</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">a</span><span class="o">;</span>     <span class="c1">// stack entries</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="no">N</span><span class="o">;</span>          <span class="c1">// size</span>
    
    <span class="c1">// constructor</span>
    <span class="kd">public</span> <span class="nf">FixedCapacityStackOfStrings</span><span class="o">(</span><span class="kt">int</span> <span class="n">cap</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[</span><span class="n">cap</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="c1">// check whether a is empty or not</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// return the size N</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// push new elem </span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="nc">String</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span><span class="o">[</span><span class="no">N</span><span class="o">++]</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// pop out item</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">[</span><span class="no">N</span><span class="o">--];</span>
    <span class="o">}</span>

    <span class="c1">// usage cases (tests)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">FixedCapacityStackOfStrings</span> <span class="n">s</span><span class="o">;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FixedCapacityStackOfStrings</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(!</span><span class="nc">StdIn</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">StdIn</span><span class="o">.</span><span class="na">readString</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">item</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"-"</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">s</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(!</span><span class="n">s</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">StdOut</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">pop</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="nc">StdOut</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"("</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">+</span> <span class="s">" left on stack)"</span><span class="o">)</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¸Šè¿°ä»£ç ç»™å‡ºçš„å®ç°æœ€æ˜æ˜¾çš„é—®é¢˜ä¹‹ä¸€å°±æ˜¯åªèƒ½å¤„ç† <code class="language-plaintext highlighter-rouge">String</code> å¯¹è±¡. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>æ³›å‹</strong> é‡æ–°å®ç°è¿™ä¸ªæ•°æ®ç±»å‹, ä½¿å…¶å¯ä»¥å¯¹ä»»ä½•ç±»å‹çš„å¯¹è±¡è¿›è¡Œå¤„ç†:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FixedCapacityStack</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Item</span><span class="o">[]</span> <span class="n">a</span><span class="o">;</span>       <span class="c1">// stack entries</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="no">N</span><span class="o">;</span>          <span class="c1">// size</span>
    
    <span class="c1">// constructor</span>
    <span class="kd">public</span> <span class="nf">FixedCapacityStackOfStrings</span><span class="o">(</span><span class="kt">int</span> <span class="n">cap</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// java does not allow creating generic arrays directly</span>
        <span class="c1">// therefore we need conversions</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Item</span><span class="o">[])</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="n">cap</span><span class="o">];</span>   
    <span class="o">}</span>

    <span class="c1">// check whether a is empty or not</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// return the size N</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// push new elem </span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="nc">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span><span class="o">[</span><span class="no">N</span><span class="o">++]</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// pop out item</span>
    <span class="kd">public</span> <span class="nc">Item</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">[</span><span class="no">N</span><span class="o">--];</span>
    <span class="o">}</span>

    <span class="c1">// usage cases (tests)</span>
    <span class="c1">// specify the type of 'Item' is 'String'</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">FixedCapacityStack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">s</span><span class="o">;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FixedCapacityStackOfStrings</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span><span class="mi">100</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(!</span><span class="nc">StdIn</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">StdIn</span><span class="o">.</span><span class="na">readString</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">item</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"-"</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">s</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(!</span><span class="n">s</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">StdOut</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">pop</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="nc">StdOut</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"("</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">+</span> <span class="s">" left on stack)"</span><span class="o">)</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ³¨æ„ä¸Šä¸‹ä¸¤ä¸ªå®ç°æ–¹å¼çš„åŒºåˆ«.</p>

<p>åœ¨ä½¿ç”¨æ³›å‹å¯¹æ•°æ®ç±»å‹çš„å®ç°æ–¹å¼è¿›è¡Œæ”¹è¿›ä½¿å…¶é€‚ç”¨äºä»»ä½•ç±»å‹çš„å¯¹è±¡å, æˆ‘ä»¬ç°åœ¨éœ€è¦è€ƒè™‘è§£é™¤å®šå®¹é™åˆ¶éœ€è¦ä½¿ç”¨ä»€ä¹ˆæ ·çš„ä¼˜åŒ–æ–¹å¼. <code class="language-plaintext highlighter-rouge">Java</code> æ•°ç»„ä¸€æ—¦åˆ›å»ºå¤§å°æ— æ³•æ”¹å˜, ä½†è¿™ä¸å½±å“æˆ‘ä»¬åœ¨å°†è¦æ”¹å˜æ ˆå†…å®¹æ—¶, ä¸€æ—¦æ£€æµ‹åˆ°å‰©ä½™å®¹é‡ä¸è¶³æ—¶å°†åŸæ•°ç»„ä¸­çš„æ‰€æœ‰å†…å®¹è¿ç§»åˆ°ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ä¸­.</p>

<p>å…·ä½“æ¥è¯´, æˆ‘ä»¬æ‰€è¿›è¡Œçš„ä¿®æ”¹å¦‚ä¸‹:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="c1">// migrate the array to a new one with its size doubled</span>
<span class="kd">private</span> <span class="kt">void</span> <span class="nf">resize</span><span class="o">(</span><span class="kt">int</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Item</span><span class="o">[]</span> <span class="n">temp</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Item</span><span class="o">[])</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="n">max</span><span class="o">];</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="no">N</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">temp</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
    <span class="o">}</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// check if the size is too small in push()</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="nc">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="no">N</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">resize</span><span class="o">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">a</span><span class="o">[</span><span class="no">N</span><span class="o">++]</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// shrink a[]'s size into a half if stack's size &lt; 1/4 * a.length </span>
<span class="c1">// to ensure the stack never overflow.</span>
<span class="c1">// if the portion &gt; 1/4: tends to do more migrations since less vacant space after shrinking</span>
<span class="c1">// if the portion &lt; 1/4: tends to waste memory space since array is vacant</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">item</span> <span class="o">=</span> <span class="n">a</span><span class="o">[--</span><span class="no">N</span><span class="o">];</span>
    <span class="n">a</span><span class="o">[</span><span class="no">N</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>    <span class="c1">// prevent object loitering</span>
    <span class="k">if</span> <span class="o">(</span><span class="no">N</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="no">N</span><span class="o">==</span><span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">/</span><span class="mi">4</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">resize</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">/</span><span class="mi">2</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¿˜åˆä¸€ä¸ªéœ€è¦å¤„ç†çš„æ”¹è¿›æ˜¯é˜²æ­¢åœ¨ <code class="language-plaintext highlighter-rouge">pop()</code> å®ç°ä¸­, <strong>è¢«å¼¹å‡ºå…ƒç´ çš„å¼•ç”¨</strong> ä»ç„¶å­˜åœ¨äºæ•°ç»„ä¸­è€Œæ— æ³•è¢« <code class="language-plaintext highlighter-rouge">Java</code> åƒåœ¾æ”¶é›†å™¨å›æ”¶, é€ æˆå¯¹è±¡æ¸¸ç¦». å®ç°è¿™ä¸€ä¼˜åŒ–çš„ä¸€ä¸ªæœ‰æ•ˆæ‰‹æ®µæ˜¯å°†è¢«å¼¹å‡ºçš„æ•°ç»„å…ƒç´ å€¼è®¾ä¸º <code class="language-plaintext highlighter-rouge">null</code>, è¿™å°† <strong>è¦†ç›–æ— æ•ˆçš„å¼•ç”¨</strong> (ä¹Ÿå°±æ˜¯æ¸…é™¤æ‰å¯¹å®ƒçš„å¼•ç”¨), å¹¶ä½¿å¾—ç³»ç»Ÿåœ¨ç”¨ä¾‹ä½¿ç”¨å®Œè¢«å¼¹å‡ºçš„å…ƒç´ å <strong>å›æ”¶å®ƒå ç”¨çš„å†…å­˜ç©ºé—´</strong>.</p>

<p>ä¸‹ä¸€ä¸ªéœ€è¦å¤„ç†çš„é—®é¢˜æ˜¯å®ç° <code class="language-plaintext highlighter-rouge">iterable</code> æ¥å£, ä½¿è¿™ä¸ªæ•°æ®ç±»å‹æ”¯æŒ <strong>è¿­ä»£</strong>:</p>

<p>é¦–å…ˆéœ€è¦åœ¨ç±»å£°æ˜ä¸­åŠ å…¥  <code class="language-plaintext highlighter-rouge">implements Iterable&lt;Item&gt;</code>, ç„¶åéœ€è¦åœ¨ç±»ä¸­å®ç°æ–¹æ³• <code class="language-plaintext highlighter-rouge">iterator()</code> å¹¶è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ <code class="language-plaintext highlighter-rouge">Iterator&lt;Item&gt;</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1">// we name the iterator to 'ReverseArrayIterator'</span>
<span class="c1">// since we need to traverse it in reverse order</span>
<span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">ReverseArrayIterator</span><span class="o">();</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è€Œè¿­ä»£å™¨æœ¬èº«åˆæ˜¯ä¸€ä¸ª <strong>å®ç°äº† <code class="language-plaintext highlighter-rouge">hasNext()</code> å’Œ <code class="language-plaintext highlighter-rouge">next()</code> æ–¹æ³•çš„ç±»</strong> çš„å¯¹è±¡:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReverseArrayIterator</span> <span class="kd">implements</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="n">item</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="no">N</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nc">Item</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">[--</span><span class="n">i</span><span class="o">];</span>
    <span class="o">}</span>
    <span class="c1">// leave it empty, we does not want to make it possible for </span>
    <span class="c1">// editing data structure inside the iterations</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¿™æ ·, æˆ‘ä»¬ä»å®šå®¹æ ˆå‡ºå‘, å®Œæˆäº† <code class="language-plaintext highlighter-rouge">Stack API</code> çš„ä¸€ç§èƒ½å¤Ÿ <strong>åŠ¨æ€è°ƒæ•´æ•°ç»„å¤§å°</strong> çš„å®ç°. ç”¨ä¾‹æ”¯æŒåˆ›å»ºä»»æ„ç±»å‹æ•°æ®çš„æ ˆ, å¹¶å¯è°ƒç”¨é«˜çº§å¾ªç¯ <code class="language-plaintext highlighter-rouge">foreach</code> è¯­å¥æŒ‰ç…§åè¿›å…ˆå‡ºçš„é¡ºåºå¯¹å…¨æ ˆå…ƒç´ è¿­ä»£è®¿é—®. è¿™ä¸€å®ç°è¿˜å¯ä»¥ç”¨ä½œå…¶ä»– <strong>é›†åˆæ•°æ®ç±»å‹</strong> çš„å®ç°çš„æ¨¡æ¿:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre><span class="c1">// for some reason, 'Iterator' is not contained in 'java.lang'</span>
<span class="c1">// so we have to import it manually</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResizingArrayStack</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Item</span> <span class="n">a</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Item</span><span class="o">[])</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span> <span class="c1">// stack elem array</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="no">N</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>                       <span class="c1">// the num of elements</span>
    
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">resize</span><span class="o">(</span><span class="kt">int</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Item</span><span class="o">[]</span> <span class="n">temp</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Item</span><span class="o">[])</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="n">max</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="no">N</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">temp</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="nc">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="no">N</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">resize</span><span class="o">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">a</span><span class="o">[</span><span class="no">N</span><span class="o">++]</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Item</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Item</span> <span class="n">item</span> <span class="o">=</span> <span class="n">a</span><span class="o">[--</span><span class="no">N</span><span class="o">];</span>
        <span class="n">a</span><span class="o">[</span><span class="no">N</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="no">N</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="no">N</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">/</span><span class="mi">4</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">resize</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">/</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReverseArrayIterator</span> <span class="kd">implements</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="n">item</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="no">N</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nc">Item</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">a</span><span class="o">[--</span><span class="n">i</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<h2 id="13-åŸºç¡€æ•°æ®ç»“æ„-é“¾è¡¨">1.3 åŸºç¡€æ•°æ®ç»“æ„: é“¾è¡¨</h2>

<p><strong>é“¾è¡¨</strong> æ˜¯ä¸€ç§é <code class="language-plaintext highlighter-rouge">Java</code> ç›´æ¥æ”¯æŒçš„æ•°æ®ç»“æ„, éœ€è¦æˆ‘ä»¬ä»é›¶å¼€å§‹æ‰‹åŠ¨å®ç°. å®ƒé€‚ç”¨äºåœ¨ <strong>é›†åˆç±»çš„æŠ½è±¡æ•°æ®ç±»å‹å®ç°</strong> ä¸­è¡¨ç¤ºæ•°æ®çš„åˆé€‚é€‰æ‹©.</p>

<p><strong>å®šä¹‰</strong>: é“¾è¡¨</p>
<blockquote>
  <p><strong>é“¾è¡¨</strong> æ˜¯ä¸€ç§ <strong>é€’å½’çš„æ•°æ®ç»“æ„</strong>, ä»»ä½•ä¸€ä¸ªé“¾è¡¨æˆ–ä¸ºç©º, æˆ–æ˜¯æŒ‡å‘ä¸€ä¸ªèŠ‚ç‚¹ (<code class="language-plaintext highlighter-rouge">Node</code>) çš„ <strong>å¼•ç”¨</strong>, ä¸”è¯¥èŠ‚ç‚¹åŒ…å«ä¸€ä¸ª <strong>æ³›å‹çš„å…ƒç´ </strong> å’Œä¸€ä¸ª <strong>æŒ‡å‘å¦ä¸€æ¡é“¾è¡¨çš„å¼•ç”¨</strong>.</p>
</blockquote>

<p>æ ¹æ®é€’å½’å®šä¹‰, æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">Node</code> ç±»å‹çš„å˜é‡å°±èƒ½è¡¨ç¤ºä¸€æ¡é“¾è¡¨, å¹¶ä¿è¯å®ƒçš„å€¼ä¸º <code class="language-plaintext highlighter-rouge">null</code> æˆ–æŒ‡å‘å¦ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">next</code> åŸŸä¹ŸæŒ‡å‘äº†å¦ä¸€æ¡é“¾è¡¨çš„ <code class="language-plaintext highlighter-rouge">Node</code> å¯¹è±¡:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
    <span class="nc">Item</span> <span class="n">item</span><span class="o">;</span>
    <span class="nc">Node</span> <span class="n">next</span><span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>é“¾è¡¨æ‰€è¡¨ç¤ºçš„æ˜¯ <strong>ä¸€åˆ—å…ƒç´ </strong>, ä¸‹é¢æˆ‘ä»¬è®¨è®ºå¦‚ä½•åœ¨é“¾è¡¨ä¸­å‘åºåˆ— <strong>æ’å…¥å…ƒç´ </strong> æˆ–ä»åºåˆ—ä¸­ <strong>åˆ é™¤å…ƒç´ </strong>.</p>

<ol>
  <li>åœ¨è¡¨å¤´æ’å…¥ç»“ç‚¹:<br />
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nc">Node</span> <span class="n">oldfirst</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span> 
<span class="n">first</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">();</span>
<span class="n">first</span><span class="o">.</span><span class="na">item</span> <span class="o">=</span> <span class="s">"..."</span><span class="o">;</span>
<span class="n">first</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">oldfirst</span><span class="o">;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>æ³¨æ„åœ¨é“¾è¡¨å¼€å¤´æ’å…¥ä¸€ä¸ªç»“ç‚¹çš„ä»£ç åªéœ€è¦å‡ è¡Œèµ‹å€¼è¯­å¥, æ•…å…¶æ‰§è¡Œæ—¶é—´ <strong>å’Œé“¾è¡¨çš„é•¿åº¦æ— å…³</strong>.</p>
  </li>
  <li>ä»è¡¨å¤´åˆ é™¤ç»“ç‚¹:<br />
 è¦ä»è¡¨å¤´åˆ é™¤ç»“ç‚¹, æˆ‘ä»¬åªéœ€è¦å°† <code class="language-plaintext highlighter-rouge">first</code> æŒ‡å‘ <code class="language-plaintext highlighter-rouge">first.next</code> å³å¯, è€Œå¦‚æ­¤æ“ä½œå <strong>åŸæ¥çš„è¡¨å¤´ç»“ç‚¹å¯¹è±¡</strong> ç”±äºæ— æ³•å†è¢«è®¿é—®åˆ°è€Œæˆä¸ºäº†ä¸€ä¸ªå°†è¢«è‡ªåŠ¨å›æ”¶çš„ <strong>å­¤å„¿</strong>, å› æ­¤ä¹Ÿæ— éœ€å…³å¿ƒåƒåœ¾å›æ”¶é—®é¢˜. åŒæ ·çš„, è¿™ä¸ªæ“ä½œçš„æ‰§è¡Œæ—¶é—´ä¹Ÿ <strong>å’Œé“¾è¡¨çš„é•¿åº¦æ— å…³</strong>.
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>åœ¨è¡¨å°¾æ’å…¥ç»“ç‚¹:<br />
ä¸€èˆ¬åœ°, æˆ‘ä»¬åªéœ€è¦å…ˆä¿å­˜æŒ‡å‘å°¾ç»“ç‚¹çš„é“¾æ¥, åˆ›å»ºæ–°çš„å°¾ç»“ç‚¹å¹¶å°†åŸæ¥çš„å°¾é“¾æ¥æŒ‡å‘è¿™ä¸ªæ–°çš„ç»“ç‚¹å³å¯å®Œæˆæ“ä½œ. ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯, è¿™ä¸€æ­¥éª¤ä¸é€‚ç”¨äºé“¾è¡¨ä¸ºç©ºçš„æƒ…å†µ, æ•…éœ€è¦é¢å¤–çš„åˆ¤æ–­:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre> <span class="nc">Node</span> <span class="n">oldlast</span> <span class="o">=</span> <span class="n">last</span><span class="o">;</span> 
 <span class="n">last</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">();</span>
 <span class="n">last</span><span class="o">.</span><span class="na">item</span> <span class="o">=</span> <span class="s">"..."</span><span class="o">;</span>
 <span class="n">oldlast</span> <span class="o">=</span> <span class="n">last</span><span class="o">;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<p>å¯è§å¯¹äº <strong>é“¾è¡¨</strong>, åœ¨è¡¨å¤´æ’å…¥, åˆ é™¤ç»“ç‚¹å’Œä»è¡¨å°¾æ’å…¥ç»“ç‚¹éƒ½ä¸å›°éš¾. ä½†æ˜¯, å¦‚æœæˆ‘ä»¬éœ€è¦åˆ é™¤æŒ‡å®šçš„ç»“ç‚¹å’Œåœ¨æŒ‡å®šç»“ç‚¹å‰æ’å…¥ä¸€ä¸ªæ–°ç»“ç‚¹åˆ™å¿…é¡» <strong>éå†æ•´ä¸ªåˆ—è¡¨</strong>. ä¸€ä¸ªæ£˜æ‰‹çš„ä¾‹å­æ˜¯, æˆ‘ä»¬å¿…é¡»ä¾¿åˆ©æ•´æ¡é“¾è¡¨å¹¶æ‰¾åˆ°æŒ‡å‘å°¾ç»“ç‚¹çš„ç»“ç‚¹æ‰èƒ½å°†é“¾è¡¨çš„å°¾ç»“ç‚¹åˆ é™¤, è€Œè¿™ç§è§£å†³æ–¹æ¡ˆæ‰€éœ€è¦çš„æ—¶é—´å’Œé“¾è¡¨çš„é•¿åº¦æˆæ­£æ¯”.</p>

<p>å®ç°å¯¹é“¾è¡¨èŠ‚ç‚¹çš„ä»»æ„æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ ‡å‡†è§£å†³æ–¹å¼æ˜¯ä½¿ç”¨ <strong>åŒå‘é“¾è¡¨</strong>, å…¶æ¯ä¸ªèŠ‚ç‚¹éƒ½å«æœ‰ä¸¤ä¸ª <strong>åˆ†åˆ«æŒ‡å‘ä¸åŒæ–¹å‘</strong> çš„é“¾æ¥, å…¶å…·ä½“å®ç°å°±æ˜¯å•é“¾è¡¨çš„ç®€å•æ‰©å±•, åœ¨æ­¤ä¸å¤šèµ˜è¿°.</p>

<p>è¦éå†é“¾è¡¨, æˆ‘ä»¬åªéœ€å°†å¾ªç¯çš„ç´¢å¼•å˜é‡ <code class="language-plaintext highlighter-rouge">x</code> <strong>åˆå§‹åŒ–ä¸ºé“¾è¡¨çš„é¦–ç»“ç‚¹</strong>, ç„¶åé€šè¿‡ <code class="language-plaintext highlighter-rouge">x.item</code> è®¿é—®ä¸ <code class="language-plaintext highlighter-rouge">x</code> ç›¸å…³çš„å…ƒç´ , å†å°† <code class="language-plaintext highlighter-rouge">x</code> è®¾ä¸º <code class="language-plaintext highlighter-rouge">x.next</code> è®¿é—®é“¾è¡¨ä¸­çš„ä¸‹ä¸€ç»“ç‚¹, å¾ªç¯å¾€å¤ç›´åˆ° <code class="language-plaintext highlighter-rouge">x</code> ä¸º <code class="language-plaintext highlighter-rouge">null</code> ä¸ºæ­¢:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="k">for</span> <span class="o">(</span><span class="nc">Node</span> <span class="n">x</span><span class="o">=</span><span class="n">first</span><span class="o">;</span> <span class="n">x</span><span class="o">!=</span><span class="kc">null</span><span class="o">;</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="na">next</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// process x.item(s)</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<h3 id="ä½¿ç”¨é“¾è¡¨å®ç°-stack-api">ä½¿ç”¨é“¾è¡¨å®ç° <code class="language-plaintext highlighter-rouge">Stack API</code></h3>

<p>å°†æ ˆä¿å­˜ä¸ºä¸€æ¡é“¾è¡¨, å°†è¡¨å¤´è§†ä¸ºæ ˆé¡¶, å®ä¾‹å˜é‡ <code class="language-plaintext highlighter-rouge">first</code> æŒ‡å‘æ ˆé¡¶, è¿™æ ·åœ¨å‘æ ˆå†… <strong>å‹å…¥å…ƒç´ </strong> æ—¶, è¯¥å…ƒç´ ä¼šæ·»åŠ åœ¨è¡¨å¤´, è€Œ <strong>å¼¹å‡ºå…ƒç´ </strong> æ—¶è¯¥å…ƒç´ ä¼šä»è¡¨å¤´åˆ é™¤.</p>

<p>è¦å®ç° <code class="language-plaintext highlighter-rouge">size()</code> æ–¹æ³•, åªéœ€ä½¿ç”¨ä¸€ä¸ªå®ä¾‹å˜é‡ <code class="language-plaintext highlighter-rouge">N</code> ä¿å­˜å…ƒç´ çš„ä¸ªæ•°, å¹¶åœ¨ <strong>å‹å…¥æˆ–å¼¹å‡º</strong> å…ƒç´ æ—¶åŒæ­¥æ›´æ–°. è€Œå®ç° <code class="language-plaintext highlighter-rouge">isEmpty()</code> æ–¹æ³•çš„æ–¹å¼å°±æ˜¯æ£€æµ‹ <code class="language-plaintext highlighter-rouge">N</code> æ˜¯å¦ä¸º $0$:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="nc">Node</span> <span class="n">first</span><span class="o">;</span>     <span class="c1">// top of the stack</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="no">N</span><span class="o">;</span>          <span class="c1">// length of the stack</span>

    <span class="c1">// a nested class defining node</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="nc">Item</span> <span class="n">item</span><span class="o">;</span>
        <span class="nc">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">first</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="nc">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Node</span> <span class="n">oldfirst</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span> 
        <span class="n">first</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">();</span>
        <span class="n">first</span><span class="o">.</span><span class="na">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
        <span class="n">first</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">oldfirst</span><span class="o">;</span>
        <span class="no">N</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Item</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Item</span> <span class="n">item</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="no">N</span><span class="o">--;</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// we will talk about the implementation of iterator later...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<h3 id="ä½¿ç”¨é“¾è¡¨å®ç°-queue-api">ä½¿ç”¨é“¾è¡¨å®ç° <code class="language-plaintext highlighter-rouge">Queue API</code></h3>

<p>å°†é˜Ÿåˆ—è¡¨ç¤ºä¸ºä¸€æ¡ä» <strong>æœ€æ—©æ’å…¥çš„å…ƒç´ </strong> åˆ° <strong>æœ€è¿‘æ’å…¥å…ƒç´ </strong> çš„é“¾è¡¨, å…¶ä¸­å®ä¾‹å˜é‡ <code class="language-plaintext highlighter-rouge">first</code> æŒ‡å‘ <strong>é˜Ÿåˆ—çš„å¼€å¤´</strong>, å®ä¾‹å˜é‡ <code class="language-plaintext highlighter-rouge">last</code> æŒ‡å‘ <strong>é˜Ÿåˆ—çš„ç»“å°¾</strong>.</p>

<p>è¦å°†ä¸€ä¸ªå…ƒç´ å…¥åˆ—, å°±éœ€è¦å°†å…¶æ·»åŠ åˆ° <strong>è¡¨å°¾</strong>, ä½†æ˜¯æ³¨æ„, åœ¨é“¾è¡¨ä¸ºç©ºæ—¶æ‰€æ–°æ·»åŠ çš„å…ƒç´  <strong>æ—¢ä¸ºé˜Ÿé¦–åˆä¸ºé˜Ÿå°¾</strong>, å› æ­¤æˆ‘ä»¬éœ€è¦å°†ä¸¤ä¸ªå®ä¾‹å˜é‡ <code class="language-plaintext highlighter-rouge">first</code> å’Œ <code class="language-plaintext highlighter-rouge">last</code> åŒæ—¶æŒ‡å‘å®ƒ.</p>

<p>è¦å°†ä¸€ä¸ªå…ƒç´ å‡ºåˆ—, åªéœ€è¦åˆ é™¤ <strong>è¡¨å¤´çš„ç»“ç‚¹</strong>, è€Œåœ¨ <strong>å‡ºåˆ—åé“¾è¡¨ä¸ºç©º</strong> æ—¶éœ€è¦æ›´æ–° <code class="language-plaintext highlighter-rouge">last</code> çš„å€¼:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Queue</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="nc">Node</span> <span class="n">first</span><span class="o">;</span>     <span class="c1">// first node of the queue</span>
    <span class="kd">private</span> <span class="nc">Node</span> <span class="n">last</span><span class="o">;</span>      <span class="c1">// last node of the queue </span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="no">N</span><span class="o">;</span>          <span class="c1">// length of the queue</span>

    <span class="c1">// a nested class defining node</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="nc">Item</span> <span class="n">item</span><span class="o">;</span>
        <span class="nc">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">first</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">enqueue</span><span class="o">(</span><span class="nc">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Node</span> <span class="n">oldlast</span> <span class="o">=</span> <span class="n">last</span><span class="o">;</span> 
        <span class="n">last</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">();</span>
        <span class="n">last</span><span class="o">.</span><span class="na">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
        <span class="n">last</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">last</span><span class="o">;</span> 
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">oldlast</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">last</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="no">N</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Item</span> <span class="nf">dequeue</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Item</span> <span class="n">item</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">last</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span> 
        <span class="no">N</span><span class="o">--;</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// we will talk about the implementation of iterator later...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<h3 id="ä½¿ç”¨é“¾è¡¨å®ç°-bag-api">ä½¿ç”¨é“¾è¡¨å®ç° <code class="language-plaintext highlighter-rouge">Bag API</code></h3>

<p>åªéœ€å¯¹ <code class="language-plaintext highlighter-rouge">Stack API</code> çš„é“¾è¡¨å®ç°è¿›è¡Œç®€å•æ”¹åŠ¨å³å¯å®ç° <code class="language-plaintext highlighter-rouge">Bag API</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Bag</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;{</span>
    
    <span class="c1">// actually we don't care the order of adding items to the bag</span>
    <span class="c1">// since it's orderless</span>
    <span class="kd">private</span> <span class="nc">Node</span> <span class="n">first</span><span class="o">;</span>     <span class="c1">// top of the bag</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="no">N</span><span class="o">;</span>          <span class="c1">// length of the bag</span>

    <span class="c1">// a nested class defining node</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="nc">Item</span> <span class="n">item</span><span class="o">;</span>
        <span class="nc">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">first</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">N</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Node</span> <span class="n">oldfirst</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span> 
        <span class="n">first</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">();</span>
        <span class="n">first</span><span class="o">.</span><span class="na">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
        <span class="n">first</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">oldfirst</span><span class="o">;</span>
        <span class="no">N</span><span class="o">++;</span>
    <span class="o">}</span>
    
    <span class="c1">// we will talk about the implementation of iterator later...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<p>ä¸‹é¢è€ƒè™‘è¿­ä»£çš„å®ç°. æˆ‘ä»¬é¦–å…ˆéœ€è¦å¼•ç”¨ <code class="language-plaintext highlighter-rouge">Java</code> çš„ <strong><code class="language-plaintext highlighter-rouge">Iterator</code> æ¥å£</strong> å¹¶åœ¨ç±»å®šä¹‰ä¸­åŠ å…¥å¯¹ <code class="language-plaintext highlighter-rouge">Iterable</code> æ¥å£çš„å®ç°å£°æ˜:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>éšåæˆ‘ä»¬æä¾› <code class="language-plaintext highlighter-rouge">iterator()</code> æ–¹æ³•:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">ListIterator</span><span class="o">();</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç„¶åå®ç° <code class="language-plaintext highlighter-rouge">ListIterator()</code>, è¿™ä¸ªç±»éœ€è¦æä¾› <code class="language-plaintext highlighter-rouge">hasNext()</code>, <code class="language-plaintext highlighter-rouge">next()</code> å’Œ <code class="language-plaintext highlighter-rouge">remove()</code> æ–¹æ³•ä¾› <strong>ç”¨ä¾‹çš„ <code class="language-plaintext highlighter-rouge">foreach()</code></strong> è¯­å¥ä½¿ç”¨:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">class</span> <span class="nc">ListIterator</span> <span class="kd">implements</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Node</span> <span class="n">current</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">current</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// intentially left blank to prevent data modification inside the `foreach` loop</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Item</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Item</span> <span class="n">item</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<h2 id="14-ç®—æ³•åˆ†æ">1.4 ç®—æ³•åˆ†æ</h2>

<p>è¿›è¡Œç®—æ³•åˆ†æçš„ç›®çš„æ˜¯ <strong>ç ”ç©¶è®¡ç®—æœºç¨‹åºçš„è¿è¡Œæ—¶é—´</strong>. å…¶ç ”ç©¶åŸºç¡€æ˜¯ <strong>ç§‘å­¦æ–¹æ³•</strong>, è¿™ä¸€è¢«ç§‘å­¦å®¶ç”¨æ¥ç†è§£è‡ªç„¶ä¸–ç•Œçš„æ–¹æ³•å¯¹äºæˆ‘ä»¬ç ”ç©¶è®¡ç®—æœºç¨‹åºçš„è¿è¡Œæ—¶é—´åŒæ ·æœ‰æ•ˆ:</p>

<ol>
  <li>ç»†è‡´åœ°è§‚å¯ŸçœŸå®ä¸–ç•Œçš„ç‰¹ç‚¹, ä¼´éšç²¾ç¡®çš„æµ‹é‡.</li>
  <li>æ ¹æ®è§‚å¯Ÿç»“æœæå‡ºå‡è®¾æ¨¡å‹.</li>
  <li>æ ¹æ®æ¨¡å‹é¢„æµ‹æœªæ¥çš„äº‹ä»¶.</li>
  <li>ç»§ç»­è§‚å¯Ÿ, å¹¶æ ¸å®é¢„æµ‹çš„å‡†ç¡®æ€§.</li>
  <li>å¦‚æ­¤åå¤, ç›´åˆ°ç¡®è®¤é¢„æµ‹ä¸è§‚å¯Ÿä¸€è‡´.</li>
</ol>

<p>æˆ‘ä»¬ä¸‹é¢ä»‹ç»ç”¨äºç®—æ³•åˆ†æçš„ <strong>æ•°å­¦æ¨¡å‹</strong>:</p>

<p>æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºä¸€ä¸ªæ•°å­¦æ¨¡å‹æè¿°ä»»æ„ç¨‹åºçš„è¿è¡Œæ—¶é—´, å³ä½¿å®é™…ä¸Šç¨‹åºçš„è¿è¡Œæ—¶é—´å—è®¸å¤šå¤æ‚çš„å› ç´ å½±å“. æˆ‘ä»¬è®¤ä¸º, ä¸€ä¸ªç¨‹åºè¿è¡Œçš„æ€»æ—¶é—´ä¸»è¦å’Œä¸¤ç‚¹æœ‰å…³:</p>

<ol>
  <li>æ‰§è¡Œæ¯æ¡è¯­å¥çš„ <strong>è€—æ—¶</strong>.</li>
  <li>æ‰§è¡Œæ¯æ¡è¯­å¥çš„ <strong>é¢‘ç‡</strong>.</li>
</ol>

<p>å‰è€…å–å†³äºè®¡ç®—æœº, ç¼–è¯‘å™¨å’Œæ“ä½œç³»ç»Ÿ, è€Œåè€…å–å†³äºç¨‹åºçš„æœ¬èº«åŠå…¶è¾“å…¥. åœ¨å¯¹ç¨‹åºçš„æ‰€æœ‰éƒ¨åˆ†è€Œè¨€æˆ‘ä»¬éƒ½çŸ¥é“äº†è¿™äº›æ€§è´¨ä¹‹å, æˆ‘ä»¬å¯ä»¥å°†å…¶ç›¸ä¹˜å¹¶å°†ç¨‹åºä¸­æ‰€æœ‰æŒ‡ä»¤çš„æˆæœ¬ç›¸åŠ , å³å¾—åˆ°äº† <strong>æ€»è¿è¡Œæ—¶é—´</strong>.</p>

<p>åŸºäºä¸Šè¿°è§„åˆ™çš„é¢‘ç‡åˆ†æå¯èƒ½ä¼šäº§ç”Ÿå¤æ‚çš„æ•°å­¦è¡¨è¾¾å¼, å› æ­¤æˆ‘ä»¬éœ€è¦å°†å…¶ç®€åŒ–. ä¸€èˆ¬åœ°, æˆ‘ä»¬å¯ä»¥ç›´æ¥å¿½ç•¥è¡¨è¾¾å¼ä¸­é‚£äº› <strong>éå¸¸å¤æ‚</strong> ä½†æ˜¯ <strong>å¹‚æ¬¡è¾ƒä½</strong>, ä¸”å¯¹æœ€ç»ˆç»“æœçš„è´¡çŒ® <strong>æ— å…³ç´§è¦</strong> çš„é¡¹:</p>

<p><strong>å®šä¹‰</strong>: è¿‘ä¼¼</p>
<blockquote>
  <p>è®°æ‰€æœ‰éšç€ $N$ çš„å¢å¤§è€Œä½¿å¾—å…¶é™¤ä»¥ $f(N)$ æ‰€å¾—æœ€ç»ˆè¶‹å‘äº $1$ çš„æ‰€æœ‰å‡½æ•°ä¸º $\sim f(N)$. ç”¨ $g(N) \sim f(N)$ è¡¨ç¤º $\frac{g(N)}{f(N)}$ éšç€ $N$ çš„å¢å¤§è¶‹è¿‘äº $1$.</p>
</blockquote>

<p><strong>å®šä¹‰</strong>: ç¨‹åºå†…å¾ªç¯</p>
<blockquote>
  <p>å¯¹äºå¤§å¤šæ•°ç¨‹åºè€Œè¨€, å…¶ä¸­æ‰§è¡Œæœ€é¢‘ç¹çš„æŒ‡ä»¤å†³å®šäº†ç¨‹åºæ‰§è¡Œçš„æ€»æ—¶é—´, æˆ‘ä»¬ç§°è¿™æ ·çš„æŒ‡ä»¤ä¸ºç¨‹åºçš„ <strong>å†…å¾ªç¯</strong>.</p>
</blockquote>

<p><strong>å®šä¹‰</strong>: æˆæœ¬æ¨¡å‹</p>
<blockquote>
  <p>å®šä¹‰äº†æˆ‘ä»¬æ‰€ç ”ç©¶çš„ç®—æ³•ä¸­çš„ <strong>åŸºæœ¬æ“ä½œ</strong> çš„æ¨¡å‹ç§°ä¸º <strong>æˆæœ¬æ¨¡å‹</strong>, æˆ‘ä»¬ä½¿ç”¨æˆæœ¬æ¨¡å‹æ¥è¯„ä¼°ç®—æ³•çš„æ€§è´¨.</p>
</blockquote>

<p>å¯¹äºå¤§å¤šæ•°ç¨‹åº, å¾—åˆ°å…¶è¿è¡Œæ—¶é—´çš„æ•°å­¦æ¨¡å‹éœ€è¦å¦‚ä¸‹çš„æ­¥éª¤:</p>
<ol>
  <li>ç¡®å®š <strong>è¾“å…¥æ¨¡å‹</strong>, å®šä¹‰é—®é¢˜çš„è§„æ¨¡.</li>
  <li>è¯†åˆ«ç¨‹åºçš„ <strong>å†…å¾ªç¯</strong>.</li>
  <li>æ ¹æ®å†…å¾ªç¯ä¸­æ‰§è¡Œçš„æ“ä½œç¡®å®šç¨‹åºçš„ <strong>æˆæœ¬æ¨¡å‹</strong>.</li>
  <li>å¯¹äºç»™å®šçš„è¾“å…¥, åˆ¤æ–­è¿™äº›æ“ä½œçš„æ‰§è¡Œé¢‘ç‡.</li>
</ol>

<p>æˆ‘ä»¬ä¸‹é¢ç»™å‡ºä¸€äº›ç®—æ³•åˆ†æçš„å¸¸è§å‡½æ•°å’Œå¸¸ç”¨è¿‘ä¼¼å‡½æ•°:</p>

<p>ç®—æ³•åˆ†æçš„å¸¸è§å‡½æ•°:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">æè¿°</th>
      <th style="text-align: left">è®°å·</th>
      <th style="text-align: left">å®šä¹‰</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">è‡ªç„¶å¯¹æ•°</td>
      <td style="text-align: left">$\ln(N)$</td>
      <td style="text-align: left">$x = \log_{e}(N), ~~ e^{x} = N$</td>
    </tr>
    <tr>
      <td style="text-align: left">ä»¥ $2$ ä¸ºåº•çš„è‡ªç„¶å¯¹æ•°</td>
      <td style="text-align: left">$\lg(N)$</td>
      <td style="text-align: left">$x = \lg_{2}(N), ~~ 2^{x} = N$</td>
    </tr>
    <tr>
      <td style="text-align: left">ä»¥ $2$ ä¸ºåº•çš„æ•´å‹å¯¹æ•°</td>
      <td style="text-align: left">$\lfloor \lg(N) \rfloor$</td>
      <td style="text-align: left">ä¸å¤§äº $\lg(N)$ çš„æœ€å¤§æ•´æ•°</td>
    </tr>
    <tr>
      <td style="text-align: left">è°ƒå’Œçº§æ•°</td>
      <td style="text-align: left">$H_N$</td>
      <td style="text-align: left">$1 + \frac{1}{2} + \frac{1}{3} + \cdots + \frac{1}{N}$</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>ç®—æ³•åˆ†æä¸­å¸¸è§çš„è¿‘ä¼¼å‡½æ•°:
|æè¿°|è¿‘ä¼¼å‡½æ•°|
|:-|:-|
|è°ƒå’Œçº§æ•°æ±‚å’Œ|$H_N \sim \ln(N)$|
|$\text{Stirling}$ å…¬å¼|$\lg(N!) \sim N \lg(N)$|
|æŒ‡æ•°å‡½æ•°|$(1-\frac{1}{x})^x \sim \frac{1}{e}$|</p>

<p>æˆ‘ä»¬å†æ€»ç»“ä¸€ä¸‹ <strong>å¢é•¿æ•°é‡çº§</strong> çš„åˆ†ç±»:</p>

<h3 id="å¸¸æ•°çº§åˆ«">å¸¸æ•°çº§åˆ«</h3>
<p>è¿è¡Œæ—¶é—´å¢é•¿æ•°é‡çº§ä¸º <strong>å¸¸æ•°</strong> çš„ç¨‹åºå®Œæˆå…¶æŒ‡å®šä»»åŠ¡æ‰€éœ€çš„æ“ä½œæ¬¡æ•°å›ºå®š, è¿è¡Œæ—¶é—´ä¸ä¾èµ–ä»»ä½•å˜é‡.</p>

<h3 id="å¯¹æ•°çº§åˆ«">å¯¹æ•°çº§åˆ«</h3>
<p>è¿è¡Œæ—¶é—´å¢é•¿æ•°é‡çº§ä¸º <strong>å¯¹æ•°</strong> çš„ç¨‹åºæ¯”å¸¸æ•°æ—¶é—´çš„ç¨‹åºç¨æ…¢, ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ˜¯ <strong>äºŒåˆ†æŸ¥æ‰¾</strong>.</p>

<h3 id="çº¿æ€§çº§åˆ«">çº¿æ€§çº§åˆ«</h3>
<p>ä½¿ç”¨ <strong>å¸¸æ•°æ—¶é—´</strong> å¤„ç†æ•°æ®ä¸­çš„æ‰€æœ‰å…ƒç´ æˆ–åŸºäºå•ä¸ª <code class="language-plaintext highlighter-rouge">for</code> å¾ªç¯çš„ç¨‹åºå¢é•¿çš„æ•°é‡çº§å°±æ˜¯ <strong>çº¿æ€§</strong> çš„, å…¶è¿è¡Œæ—¶é—´å’Œ $N$ æˆæ­£æ¯”.</p>

<h3 id="å¹³æ–¹çº§åˆ«">å¹³æ–¹çº§åˆ«</h3>
<p>è¿è¡Œæ—¶é—´çš„å¢é•¿æ•°é‡çº§ä¸º $N^2$ çš„ç¨‹åºä¸€èˆ¬å«æœ‰ä¸¤ä¸ªåµŒå¥—çš„ <code class="language-plaintext highlighter-rouge">for</code> å¾ªç¯.</p>

<h3 id="ç«‹æ–¹çº§åˆ«">ç«‹æ–¹çº§åˆ«</h3>
<p>å’Œå¹³æ–¹çº§åˆ«ç¨‹åºç±»ä¼¼, ä¸€ä¸ªè¿è¡Œæ—¶é—´å¢é•¿æ•°é‡çº§ä¸º $N^3$ çš„ç¨‹åºä¸€èˆ¬å«æœ‰ä¸‰ä¸ªåµŒå¥—çš„ <code class="language-plaintext highlighter-rouge">for</code> å¾ªç¯.</p>

<h3 id="æŒ‡æ•°çº§åˆ«">æŒ‡æ•°çº§åˆ«</h3>
<p>è¿™æ ·çš„ç¨‹åºè¿è¡Œæ—¶é—´å’Œ $2^N$ æˆ–æ›´é«˜çº§åˆ«çš„å‡½æ•°æˆæ­£æ¯”.</p>

<p><br /></p>

<h2 id="15-æ¡ˆä¾‹ç ”ç©¶-å¹¶æŸ¥é›†">1.5 æ¡ˆä¾‹ç ”ç©¶: å¹¶æŸ¥é›†</h2>

<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªåŸºç¡€çš„è®¡ç®—æ€§é—®é¢˜è¯´æ˜è®¾è®¡å’Œåˆ†æç®—æ³•çš„åŸºæœ¬æ–¹æ³•.</p>

<p>é¦–å…ˆå¯¹é—®é¢˜è¿›è¡Œè¯´æ˜: é—®é¢˜çš„è¾“å…¥æ˜¯ <strong>ä¸€åˆ—æ•´æ•°å¯¹</strong>, å…¶ä¸­æ¯ä¸ªæ•´æ•°éƒ½è¡¨ç¤ºä¸€ä¸ªæŸç§ç±»å‹çš„å¯¹è±¡, ä¸€å¯¹æ•´æ•° $p, q$ å¯è¢«ç†è§£ä¸º <strong>$p, q$ æ˜¯ç›¸è¿çš„</strong>. å¹¶ä¸”, æˆ‘ä»¬å‡è®¾ <strong>â€œç›¸è¿â€</strong> æ˜¯ä¸€ç§ <strong>ç­‰ä»·å…³ç³»</strong>, è¿™æ„å‘³ç€å®ƒåŒæ—¶å…·å¤‡ <strong>è‡ªåæ€§, å¯¹ç§°æ€§å’Œä¼ é€’æ€§</strong>.</p>

<p>ç­‰ä»·å…³ç³»èƒ½å¤Ÿå°†å¯¹è±¡åˆ†ä¸º <strong>å¤šä¸ªç­‰ä»·ç±»</strong>, åœ¨æˆ‘ä»¬çš„é—®é¢˜ä¸­, ä¸¤ä¸ªå¯¹è±¡å½“ä¸”ä»…å½“å®ƒä»¬ç›¸è¿æ—¶æ‰å±äºåŒä¸€ä¸ªç­‰ä»·ç±». è€Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ç¼–å†™ç¨‹åºè¿‡æ»¤æ‰åºåˆ—ä¸­æ‰€æœ‰ <strong>æ— æ„ä¹‰çš„</strong> æ•´æ•°å¯¹, ä¹Ÿå°±æ˜¯é‚£äº› <strong>ä¸¤ä¸ªæ•´æ•°åŒå±ä¸€ä¸ªç­‰ä»·ç±»</strong> çš„æ•´æ•°å¯¹.</p>

<p>ä¸ºäº†è¾¾åˆ°æ‰€æœŸæœ›çš„æ•ˆæœ, æˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„ç”¨äºä¿å­˜ç¨‹åºå·²çŸ¥çš„ <strong>å…¨éƒ¨æ•´æ•°å¯¹</strong> çš„ <strong>è¶³å¤Ÿå¤šçš„ä¿¡æ¯</strong>, å¹¶ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥åˆ¤æ–­ä¸€å¯¹æ–°å¯¹è±¡æ˜¯å¦æ˜¯ <strong>ç›¸è¿</strong> çš„. è¿™ä¸ªé—®é¢˜ä¸€èˆ¬è¢«ç§°ä¸º <strong>åŠ¨æ€è¿é€šæ€§é—®é¢˜</strong>, å®ƒåœ¨ç½‘ç»œ (è®¡ç®—æœºç½‘ç»œ, ç¤¾äº¤ç½‘ç»œ, é›†æˆç”µè·¯ç½‘ç»œç­‰), ç‰©ç†å­¦ç­‰æ–¹é¢å‡æœ‰å¹¿æ³›çš„åº”ç”¨.</p>

<p>æˆ‘ä»¬åŒæ—¶è§„å®šä½¿ç”¨ç½‘ç»œæ–¹é¢çš„æœ¯è¯­ä»¥é™å®šè¯é¢˜. æˆ‘ä»¬å°† â€œå¯¹è±¡â€ ç§°ä¸º â€œè§¦ç‚¹â€, å°†ä¸€ä¸ªæ•´æ•°å¯¹ç§°ä¸º â€œè¿æ¥â€, å°†ç­‰ä»·ç±»ç§°ä¸º â€œè¿é€šåˆ†é‡â€ æˆ–æ˜¯ â€œåˆ†é‡â€. å¹¶ä¸”ç”¨ $0$ åˆ° $N-1$ æ ‡è®°è¿™ $N$ ä¸ªè§¦ç‚¹.</p>

<p>ä¸ºäº† <strong>ç²¾ç¡®çš„å®šä¹‰é—®é¢˜</strong>, æˆ‘ä»¬å°†è®¾è®¡ä¸€ä»½ <code class="language-plaintext highlighter-rouge">API</code> å°è£…æ‰€éœ€çš„åŸºæœ¬æ“ä½œ: åˆå§‹åŒ–, è¿æ¥ä¸¤ä¸ªè§¦ç‚¹, åˆ¤æ–­åŒ…å«æŸä¸ªè§¦ç‚¹çš„åˆ†é‡, åˆ¤æ–­ä¸¤ä¸ªè§¦ç‚¹æ˜¯å¦å¤„äºåŒä¸€åˆ†é‡ä¹‹é‡, ä»¥åŠè¿”å›æ‰€æœ‰åˆ†é‡çš„æ•°é‡.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left"><code class="language-plaintext highlighter-rouge">public class UF</code></th>
      <th style="text-align: left">Â </th>
      <th style="text-align: left">Â </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Â </td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">UF(int N)</code></td>
      <td style="text-align: left">ä»¥æ•´æ•°æ ‡è¯†åˆå§‹åŒ– $N$ ä¸ªè§¦ç‚¹</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">void</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">union(int p, int q)</code></td>
      <td style="text-align: left">è¿æ¥ $p$ å’Œ $q$</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">int</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">find(int p)</code></td>
      <td style="text-align: left">è¿”å›$p$ æ‰€åœ¨çš„åˆ†é‡çš„æ ‡è¯†ç¬¦</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">boolean</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">connected(int p, int q)</code></td>
      <td style="text-align: left">æ£€æµ‹ $p$ å’Œ $q$ æ˜¯å¦åœ¨åŒä¸€ä¸ªåˆ†é‡ä¸­</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">int</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">count()</code></td>
      <td style="text-align: left">è¿”å›è¿é€šåˆ†é‡çš„æ•°é‡</td>
    </tr>
  </tbody>
</table>

<p>è‹¥ä¸¤ä¸ªè§¦ç‚¹åœ¨ä¸åŒçš„åˆ†é‡ä¸­, <code class="language-plaintext highlighter-rouge">union()</code> æ“ä½œä¼šå°†ä¸¤ä¸ªåˆ†é‡ <strong>å½’å¹¶</strong>. <code class="language-plaintext highlighter-rouge">find()</code> æ“ä½œä¼šè¿”å›ç»™å®šè§¦ç‚¹æ‰€åœ¨çš„è¿é€šåˆ†é‡çš„æ ‡è¯†ç¬¦, <code class="language-plaintext highlighter-rouge">connected()</code> æ“ä½œèƒ½åˆ¤æ–­ä¸¤ä¸ªè§¦ç‚¹æ˜¯å¦å­˜åœ¨äºåŒä¸€ä¸ªåˆ†é‡ä¸­, <code class="language-plaintext highlighter-rouge">count()</code> æ–¹æ³•ä¼šè¿”å›æ‰€æœ‰è¿é€šåˆ†é‡çš„æ•°é‡.</p>

<p>å¯¹è¿™ä»½ <code class="language-plaintext highlighter-rouge">API</code> çš„å®ç°ç­‰ä»·äºè§£å†³æ‰€æåˆ°çš„åŠ¨æ€è¿é€šæ€§é—®é¢˜. æ‰€æœ‰çš„å®ç°éƒ½åº”è¯¥:</p>
<ol>
  <li>å®šä¹‰ä¸€ç§è¡¨ç¤º <strong>å·²çŸ¥è¿æ¥</strong> çš„æ•°æ®ç»“æ„.</li>
  <li>åŸºäºæ­¤æ•°æ®ç»“æ„å®ç°é«˜æ•ˆçš„ <code class="language-plaintext highlighter-rouge">union()</code>, <code class="language-plaintext highlighter-rouge">find()</code>, <code class="language-plaintext highlighter-rouge">connected()</code>, <code class="language-plaintext highlighter-rouge">count()</code> æ–¹æ³•.</li>
</ol>

<p>æˆ‘ä»¬é¦–å…ˆä½¿ç”¨ä¸€ä¸ªä»¥ <strong>è§¦ç‚¹</strong> ä¸ºç´¢å¼•çš„æ•°ç»„ <code class="language-plaintext highlighter-rouge">id[]</code> ä½œä¸ºåŸºæœ¬æ•°æ®ç»“æ„, å®ç°è¯¥ <code class="language-plaintext highlighter-rouge">API</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UF</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">id</span><span class="o">;</span>   <span class="c1">// the id of the components</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span>   <span class="c1">// the number of the components</span>

    <span class="c1">// constructor responsible for initialization</span>
    <span class="kd">public</span> <span class="nf">UF</span><span class="o">(</span><span class="kt">int</span> <span class="no">N</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">count</span> <span class="o">=</span> <span class="no">N</span><span class="o">;</span>
        <span class="n">id</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="no">N</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="no">N</span><span class="o">;</span> <span class="n">i</span><span class="o">++;){</span>
            <span class="n">id</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">count</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">connected</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">,</span> <span class="kt">int</span> <span class="n">q</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">find</span><span class="o">(</span><span class="n">p</span><span class="o">)</span> <span class="o">==</span> <span class="n">find</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">find</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// we will implement it later...</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">union</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">,</span> <span class="kt">int</span> <span class="n">q</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// we will implement it later...</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Union-Find</code> çš„æˆæœ¬æ¨¡å‹æ˜¯: æ•°ç»„çš„è®¿é—®æ¬¡æ•° (è®¿é—®ä»»æ„æ•°ç»„å…ƒç´ çš„æ¬¡æ•°, æ— è®ºè¯»å†™å‡ç®—åœ¨å†…).</p>

<p>ä¸‹é¢, æˆ‘ä»¬å°†è®¨è®ºä¸‰ç§å‡æ ¹æ®ä»¥è§¦ç‚¹ä¸ºç´¢å¼•çš„ <code class="language-plaintext highlighter-rouge">id[]</code> æ•°ç»„ç¡®å®šä¸¤ä¸ªè§¦ç‚¹æ˜¯å¦å­˜åœ¨äºç›¸åŒçš„è¿é€šåˆ†é‡ä¸­çš„ä¸åŒå®ç°:</p>

<h3 id="quick-find-ç®—æ³•"><code class="language-plaintext highlighter-rouge">quick-find</code> ç®—æ³•</h3>

<p>ä¸€ç§æ–¹æ³•æ˜¯, ä¿è¯ <strong>å½“ä¸”ä»…å½“ $\text{id}[p] = \text{id}[q]$ æ—¶ $p$ å’Œ $q$ ç›¸é€š</strong>. ä¹Ÿå°±æ˜¯è¯´, ä½äºåŒä¸€ä¸ªè¿é€šåˆ†é‡ä¸­çš„è§¦ç‚¹åœ¨ $\text[id][]$ ä¸­çš„å€¼å¿…é¡» <strong>å…¨éƒ¨ç›¸åŒ</strong>. åœ¨æ­¤åŸºç¡€ä¸Š, æˆ‘ä»¬æœ‰:</p>
<ol>
  <li>å¯¹äº <code class="language-plaintext highlighter-rouge">connected(p, q)</code>, å®ƒåªéœ€åˆ¤æ–­ <code class="language-plaintext highlighter-rouge">id[p] == id[q]</code>, å½“å…¶ä¸ºçœŸæ—¶æ‰è¿”å› <code class="language-plaintext highlighter-rouge">true</code>.</li>
  <li>å¯¹äº <code class="language-plaintext highlighter-rouge">union(p, q)</code>, é¦–å…ˆéœ€è¦æ£€æµ‹ <code class="language-plaintext highlighter-rouge">p</code> å’Œ <code class="language-plaintext highlighter-rouge">q</code> æ˜¯å¦å·²ç»ä½äºåŒä¸€åˆ†é‡ä¸­, è‹¥ä¸æ˜¯çš„è¯, ä»–å°±éœ€è¦ <strong>éå†æ•°ç»„</strong> å°†ä¸€ç±»åˆ†é‡ä¸­æ‰€æœ‰çš„è§¦ç‚¹å¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºå¦ä¸€åˆ†é‡å¯¹åº”çš„å€¼.</li>
</ol>

<p>åŸºäºè¿™ä¸€åŸåˆ™çš„å®ç°å¦‚ä¸‹:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">int</span> <span class="nf">find</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">id</span><span class="o">[</span><span class="n">p</span><span class="o">];</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">union</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">,</span> <span class="kt">int</span> <span class="n">q</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">pID</span> <span class="o">=</span> <span class="n">find</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">qID</span> <span class="o">=</span> <span class="n">find</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>

    <span class="c1">// check whether p and q are already "identical"</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">pID</span> <span class="o">==</span> <span class="n">qID</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// if not, modify p's component into q's value</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">id</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">id</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">==</span> <span class="n">pID</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">id</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">pID</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">count</span><span class="o">--;</span>    <span class="c1">// merged, num of components -1</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç®—æ³•åˆ†æ:</p>

<p><code class="language-plaintext highlighter-rouge">find()</code> æ“ä½œæ˜¾ç„¶æ˜¯æå¿«çš„, å› ä¸ºå®ƒåªéœ€è¦è®¿é—®ä¸€æ¬¡ <code class="language-plaintext highlighter-rouge">id[]</code> æ•°ç»„. ä½†ç”±äºå¯¹äºæ¯ä¸€å¯¹è¾“å…¥, <code class="language-plaintext highlighter-rouge">union()</code> éƒ½éœ€è¦æ‰«ææ•´ä¸ª <code class="language-plaintext highlighter-rouge">id[]</code> æ•°ç»„, å› æ­¤å®ƒå¹¶ä¸é€‚ç”¨äºå¤§å‹é—®é¢˜.</p>

<p><strong>å‘½é¢˜ 1.1</strong></p>

<blockquote>
  <p>åœ¨ <code class="language-plaintext highlighter-rouge">quick-find</code> ç®—æ³•ä¸­, å½’å¹¶ä¸¤ä¸ªå˜é‡çš„ <code class="language-plaintext highlighter-rouge">union()</code> æ“ä½œè®¿é—®æ•°ç»„çš„æ¬¡æ•°åœ¨ $(N+3)$ åˆ° $(2N+1)$ ä¹‹é—´.</p>
</blockquote>

<p><strong>è¯æ˜</strong></p>
<blockquote>
  <p>å½’å¹¶ä¸¤ä¸ªåˆ†é‡çš„ <code class="language-plaintext highlighter-rouge">union()</code> æ“ä½œé¦–å…ˆéœ€è¦è°ƒç”¨ä¸¤æ¬¡ <code class="language-plaintext highlighter-rouge">find()</code>, è€Œæ˜¾ç„¶æ¯è°ƒç”¨ <code class="language-plaintext highlighter-rouge">find()</code> ä¸€æ¬¡, æ™ºæ…§è®¿é—®ä¸€æ¬¡æ•°ç»„; ç„¶å <code class="language-plaintext highlighter-rouge">union()</code> æ“ä½œè¦æ£€æŸ¥ <code class="language-plaintext highlighter-rouge">id[]</code> æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ , å¹¶æ”¹å˜å®ƒä»¬ä¸­çš„æœ€å°‘ $1$ ä¸ª, æœ€å¤š $N-1$ ä¸ªçš„å€¼. å› æ­¤è®¿é—®æ¬¡æ•°åœ¨ $2+N+1 = N+3$ åˆ° $2+N+(N-1) = 2N+1$ ä¹‹é—´. $\blacksquare$</p>
</blockquote>

<p>å‡å¦‚æˆ‘ä»¬ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">quick-find</code> ç®—æ³•è§£å†³åŠ¨æ€è¿é€šæ€§é—®é¢˜å¹¶æœ€ååªå¾—åˆ°äº†ä¸€ä¸ªè¿é€šåˆ†é‡, åˆ™è¿™è‡³å°‘éœ€è¦è°ƒç”¨ $N-1$ æ¬¡ <code class="language-plaintext highlighter-rouge">union()</code>, ä¹Ÿå°±æ˜¯è‡³å°‘ $(N+3)(N-1)$, å³è¿‘ä¼¼äº $N^2$ æ¬¡æ•°ç»„è®¿é—®. å› æ­¤, æˆ‘ä»¬å¯ä»¥ç«‹åˆ»çŒœæƒ³å¾—åˆ°, è¯¥ç®—æ³•çš„å¤æ‚åº¦æ˜¯ $n^2$ çº§åˆ«çš„. ä¸ºäº†æé«˜ <code class="language-plaintext highlighter-rouge">union()</code> çš„é€Ÿåº¦, æˆ‘ä»¬éœ€è¦ç»§ç»­æ”¹è¿›.</p>

<p><br /></p>

<h3 id="quick-union-ç®—æ³•"><code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•</h3>

<p>ä¸‹é¢æˆ‘ä»¬è®¨è®ºçš„é‡ç‚¹æ˜¯æé«˜ <code class="language-plaintext highlighter-rouge">union()</code> çš„é€Ÿåº¦. è¯¥ç®—æ³•å’Œ <code class="language-plaintext highlighter-rouge">quick-find</code> äº’è¡¥, ä¹ŸåŸºäºç›¸åŒçš„æ•°æ®ç»“æ„: <strong>ä»¥è§¦ç‚¹ä½œä¸ºç´¢å¼•çš„ <code class="language-plaintext highlighter-rouge">id[]</code> æ•°ç»„</strong>. ä½†åœ¨è¯¥ç®—æ³•ä¸­, æˆ‘ä»¬å®šä¹‰æ¯ä¸ªè§¦ç‚¹æ‰€å¯¹åº”çš„ <code class="language-plaintext highlighter-rouge">id[]</code> å…ƒç´ å‡ä¸º <strong>åŒä¸€ä¸ªåˆ†é‡ä¸­å¦å¤–ä¸€ä¸ªè§¦ç‚¹ (ä¹Ÿå¯èƒ½æ˜¯å®ƒæœ¬èº«) çš„åç§°</strong>, å¹¶ä¸”æˆ‘ä»¬å°†è¿™ç§è”ç³»ç§°ä¸º <strong>é“¾æ¥</strong>.</p>

<p>åœ¨å®ç° <code class="language-plaintext highlighter-rouge">find()</code> æ–¹æ³•æ—¶, æˆ‘ä»¬ä»ç»™å®šçš„è§¦ç‚¹å¼€å§‹ç”±å…¶é“¾æ¥å¾—åˆ°å¦ä¸€ä¸ªè§¦ç‚¹, å¹¶å¦‚æ­¤ç»§ç»­å°±å¯ä»¥é¡ºè—¤æ‘¸ç“œç›´åˆ°åˆ°è¾¾ä¸€ä¸ªæŒ‡å‘å…¶è‡ªèº«çš„ <strong>æ ¹è§¦ç‚¹</strong>, è€Œå¦‚æœä¸¤ä¸ªè§¦ç‚¹å­˜åœ¨äºåŒä¸€ä¸ªè¿é€šåˆ†é‡ä¸­, é‚£ä¹ˆç”±å®ƒä»¬å¼€å§‹ä¸€å®šå¯ä»¥åˆ†åˆ«æœ€ç»ˆåˆ°è¾¾ <strong>åŒä¸€ä¸ªæ ¹è§¦ç‚¹</strong>.</p>

<p>è¿™ä¸€ç‰¹æ€§éœ€è¦å°å¿ƒçš„å®ç° <code class="language-plaintext highlighter-rouge">union()</code> æ–¹æ³•æ¥ä¿è¯. åœ¨åˆå¹¶åˆ†é‡ (<code class="language-plaintext highlighter-rouge">union(p, q)</code>)æ—¶, æˆ‘ä»¬éœ€è¦ç”± <code class="language-plaintext highlighter-rouge">p</code> å’Œ <code class="language-plaintext highlighter-rouge">q</code> çš„é“¾æ¥åˆ†åˆ«æ‰¾åˆ°å®ƒä»¬çš„æ ¹è§¦ç‚¹, ç„¶åå°†ä¸€ä¸ªæ ¹è§¦ç‚¹é“¾æ¥åˆ°å¦å¤–ä¸€ä¸ªä¸Šå°±å¯ä»¥å°†ä¸¤ä¸ªåˆ†é‡åˆäºŒä¸ºä¸€.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="kd">private</span> <span class="kt">int</span> <span class="nf">find</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">p</span> <span class="o">!=</span> <span class="n">id</span><span class="o">[</span><span class="n">p</span><span class="o">])</span> <span class="o">{</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">id</span><span class="o">[</span><span class="n">p</span><span class="o">];</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">union</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">,</span> <span class="kt">int</span> <span class="n">q</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">pRoot</span> <span class="o">=</span> <span class="n">find</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">qRoot</span> <span class="o">=</span> <span class="n">find</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">pRoot</span> <span class="o">==</span> <span class="n">qRoot</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">id</span><span class="o">[</span><span class="n">pRoot</span><span class="o">]</span> <span class="o">=</span> <span class="n">qRoot</span><span class="o">;</span>
    <span class="n">count</span><span class="o">--;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç®—æ³•åˆ†æ:</p>

<p>çœ‹ä¸Šå» <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•æ¯” <code class="language-plaintext highlighter-rouge">quick-find</code> è¦å¿«, å› ä¸ºå®ƒå¹¶ä¸éœ€è¦ä¸ºæ¯å¯¹è¾“å…¥ <strong>éå†æ•´ä¸ªæ•°ç»„</strong>. åœ¨æœ€åæƒ…å†µä¸‹, <code class="language-plaintext highlighter-rouge">fund()</code> éœ€è¦ $2N-1$ æ¬¡æ•°ç»„è®¿é—®æ‰èƒ½å¾—åˆ°ä¸€ä¸ªè§¦ç‚¹æ‰€åœ¨çš„åˆ†é‡æ ‡è¯†, è€Œåœ¨æœ€å¥½æƒ…å†µä¸‹åªéœ€è¦ $1$ æ¬¡. ç”±äºæˆ‘ä»¬å®Œå…¨å¯ä»¥æ„é€ ä¸€ä¸ªæœ€åæƒ…å†µçš„è¾“å…¥ä½¿å¾—å…¶è¿è¡Œæ—¶é—´ä¸º $n^2$ çº§åˆ«, å› æ­¤å®ƒå¹¶ä¸èƒ½åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½å–å¾—æ¯” <code class="language-plaintext highlighter-rouge">quick-find</code> ç®—æ³•æ›´å¥½çš„è¡¨ç°.</p>

<p><br /></p>

<h3 id="åŠ æƒ-quick-union-ç®—æ³•">åŠ æƒ <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•</h3>

<p>å¯¹ <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•è¿›è¡Œç®€å•çš„ä¿®æ”¹å°±èƒ½æ˜¾è‘—åœ°æå‡å®ƒçš„æ€§èƒ½. ä¸åŒäº <code class="language-plaintext highlighter-rouge">quick-find</code> çš„<code class="language-plaintext highlighter-rouge">union()</code> å®ç°, æˆ‘ä»¬ç°åœ¨ä¼šåœ¨å°†ä¸¤ä¸ªåˆ†é‡åˆå¹¶å‰è®°å½•æ¯ä¸€ä¸ªåˆ†é‡æ‰€å¯¹åº”çš„é“¾æ¥æ ‘çš„å¤§å°, å¹¶æ€»æ˜¯å°† <strong>è¾ƒå°çš„æ ‘è¿æ¥åˆ°è¾ƒå¤§çš„ä¸Š</strong>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WeightedQuickUnionUF</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">id</span><span class="o">;</span>   <span class="c1">// father-links array (node index)</span>
    <span class="kd">private</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">sz</span><span class="o">;</span>   <span class="c1">// each root-node's corresponding components' size</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span><span class="o">;</span>  <span class="c1">// num of components</span>

    <span class="kd">public</span> <span class="nf">WeightedQuickUnionUF</span><span class="o">(</span><span class="kt">int</span> <span class="no">N</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">count</span> <span class="o">=</span> <span class="no">N</span><span class="o">;</span>
        <span class="n">id</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="no">N</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="no">N</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">id</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="no">N</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="no">N</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">sz</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">count</span><span class="o">()</span> <span class="o">{</span>

        <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">connected</span><span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">,</span> <span class="kt">int</span> <span class="n">q</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">find</span><span class="o">(</span><span class="n">p</span><span class="o">)</span> <span class="o">==</span> <span class="n">find</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">find</span><span class="o">(</span><span class="n">p</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">p</span> <span class="o">!=</span> <span class="n">id</span><span class="o">[</span><span class="n">p</span><span class="o">])</span> <span class="o">{</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">id</span><span class="o">[</span><span class="n">p</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">union</span> <span class="o">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">,</span> <span class="kt">int</span> <span class="n">q</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">find</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">find</span><span class="o">(</span><span class="n">q</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">sz</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;</span> <span class="n">sz</span><span class="o">[</span><span class="n">j</span><span class="o">])</span> <span class="o">{</span>
            <span class="n">id</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">;</span> 
            <span class="n">sz</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">+=</span> <span class="n">sz</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">id</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span> 
            <span class="n">sz</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+=</span> <span class="n">sz</span><span class="o">[</span><span class="n">j</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="n">count</span><span class="o">--;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>å‘½é¢˜ 1.2</strong></p>

<blockquote>
  <p>å¯¹ $N$ ä¸ªè§¦ç‚¹, åŠ æƒ <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•æ„é€ çš„æ£®æ—ä¸­ä»»æ„èŠ‚ç‚¹çš„æ·±åº¦æœ€å¤šä¸º $\lg(N)$.</p>
</blockquote>

<p><strong>è¯æ˜</strong></p>

<blockquote>
  <p>ä¸‹é¢é€šè¿‡è¯æ˜ä¸€ä¸ªæ›´å¼ºçš„å‘½é¢˜è§£å†³è¿™ä¸ªé—®é¢˜: æ£®æ—ä¸­å¤§å°ä¸º $k$ çš„æ ‘é«˜åº¦æœ€å¤šä¸º $\lg(k)$. <br />
åˆå§‹æƒ…å†µ: $k=1$ æ—¶æ ‘çš„é«˜åº¦ä¸º $0$.<br />
å½’çº³å‡è®¾: å¤§å°ä¸º $i$ çš„æ ‘é«˜åº¦æœ€å¤šä¸º $\lg(i)$, å…¶ä¸­ $i \leqslant k$.</p>

  <p>è®¾$i \leqslant k$ ä¸” $i+j=k$. è€Œå½“æˆ‘ä»¬å°†å¤§å°ä¸º $i$ å’Œ $j$ çš„æ ‘åˆå¹¶æ—¶, è¾ƒå°çš„æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„æ·±åº¦å¢åŠ äº† $1$, è€Œåˆå¹¶åçš„æ ‘å¤§å°ä¸º $i+j=k$. è€Œ 
\(1 + \lg(i) = \lg(2i) = \lg(i + i) \leqslant \lg(i+j) = \lg(k)\)
æ•…æ€§è´¨æˆç«‹. $\blacksquare$</p>
</blockquote>

<p><strong>æ¨è®º</strong></p>

<blockquote>
  <p>å¯¹äº <strong>åŠ æƒ <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•</strong> å’Œ $N$ ä¸ªè§¦ç‚¹, åœ¨æœ€åæƒ…å†µä¸‹ <code class="language-plaintext highlighter-rouge">find()</code>, <code class="language-plaintext highlighter-rouge">connected()</code> å’Œ <code class="language-plaintext highlighter-rouge">union()</code> çš„æˆæœ¬å¢é•¿æ•°é‡çº§ä¸º $\log(N)$.</p>
</blockquote>

<p><strong>è¯æ˜</strong></p>
<blockquote>
  <p>åœ¨æ£®æ—ä¸­, å¯¹äºä»ä¸€ä¸ªç»“ç‚¹åˆ°å®ƒçš„æ ¹ç»“ç‚¹çš„è·¯å¾„ä¸Šçš„æ¯ä¸ªç»“ç‚¹, æ¯ç§æ“ä½œæœ€å¤šåªä¼šè®¿é—®æ•°ç»„å¸¸æ•°æ¬¡. ç”±ä¸Šè¿°å‘½é¢˜å¾—: éšç€æ ‘çš„å¢é•¿, å„ç§æ“ä½œå¯¹æ•°ç»„çš„è®¿é—®æ¬¡æ•°å’Œæ ‘çš„é«˜åº¦å‘ˆçº¿æ€§å…³ç³», æ•…æ¨è®ºæˆç«‹. $\blacksquare$</p>
</blockquote>

<p>ç”±ä¸Šè¿°å‘½é¢˜å’Œæ¨è®ºå¯çŸ¥, <strong>åŠ æƒ <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•</strong> å¤„ç† $N$ ä¸ªè§¦ç‚¹å’Œ $M$ æ¡è¿æ¥æ—¶æœ€å¤šè®¿é—®æ•°ç»„çš„æ¬¡æ•°ä¸º</p>

\[cM \cdot \lg(N)\]

<p>å…¶ä¸­ $c$ ä¸ºå¸¸æ•°, è€Œ <code class="language-plaintext highlighter-rouge">quick-find</code>ç®—æ³• å’Œ <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•çš„æœ€åæƒ…å†µéœ€è¦è®¿é—®æ•°ç»„</p>

\[N \cdot M\]

<p>æ¬¡.</p>

<p>å› æ­¤, åŠ æƒ <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•æ˜¯ä¸‰ç§ç®—æ³•ä¸­å”¯ä¸€å¯ä»¥è§£å†³ <strong>å¤§å‹å®é™…é—®é¢˜</strong> çš„ç®—æ³•.</p>

<p>åœ¨ <strong>åŠ æƒ <code class="language-plaintext highlighter-rouge">quick-union</code> ç®—æ³•</strong> çš„åŸºç¡€ä¸Š, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>è·¯å¾„å‹ç¼©</strong> è¿›ä¸€æ­¥åœ°ä¼˜åŒ–ç®—æ³•çš„æ€§èƒ½. ç†æƒ³æƒ…å†µä¸‹, æˆ‘ä»¬å¸Œæœ›æ¯ä¸ªç»“ç‚¹éƒ½ç›´æ¥é“¾æ¥åˆ°å®ƒçš„æ ¹ç»“ç‚¹ä¸Š, è€ŒåŒæ—¶ä¸èƒ½åƒ <code class="language-plaintext highlighter-rouge">quick-find</code> ç®—æ³•ä¸€æ ·é€šè¿‡å¤§é‡ä¿®æ”¹é“¾æ¥å®ç°è¿™ä¸€ç‚¹. ä¸ºäº†æ¥è¿‘è¿™ç§ç†æƒ³çŠ¶æ€, æˆ‘ä»¬å¯ä»¥åœ¨ <strong>æ£€æŸ¥èŠ‚ç‚¹çš„åŒæ—¶å°†å®ƒä»¬ç›´æ¥é“¾æ¥åˆ°æ ¹èŠ‚ç‚¹</strong>. è¦å®ç° <strong>è·¯å¾„å‹ç¼©</strong>, æˆ‘ä»¬åªéœ€è¦ä¸º <code class="language-plaintext highlighter-rouge">find()</code> æ·»åŠ ä¸€ä¸ªå¾ªç¯ä»¥å°†åœ¨è·¯å¾„ä¸Šé‡åˆ°çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½é“¾æ¥åˆ°æ ¹ç»“ç‚¹ä¸Š.</p>

:ET