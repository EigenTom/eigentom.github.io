---
layout:     post
title:      人工智能和博弈论:均衡问题, 纳什均衡和混合策略
subtitle:    Equilibrium, Nash Equilibrium and Mixed Strategy
date:       2022-09-27
author:     R1NG
header-img: img/post-bg-comp34111.jpg
description: 本章将介绍均衡问题的概念并讨论一系列与均衡问题相关的概念. 
catalog: true
tags:
    - 课程笔记
    - 博弈论
    - 人工智能
---

# 2. 均衡问题, 纳什均衡和混合策略

本章主要讨论两个问题: **成功地进行一场博弈意味着什么**, 以及 **如何寻找一个算得上是 “好” (`Desirable`) 的策略**.

## 2.1 最优反应 (`Best Response`)

首先对 “何为成功博弈” 给出定义:

不妨假设一个 **双人参与**, **零和** 且 **信息完全** 的博弈. 自然, 假设作为博弈的其中一方, 我们会关注 **使用什么样的策略会导致己方的收益最大化**.

形式上, 我们如此定义 “最好的决策”, **最优反应**:

**定义 2.1.1** (最优反应 `Best Response`):
> 考虑存在 $n$ 个决策者的一个决策. 对决策者 $1$ 而言, 如果存在一个决策 $s_1^*$, 使得它对于任何不同的决策都有:
> 
> $$p_1(s_1^*, s_2, \cdots, s_l) \geqslant p_1(s_1, s_2, \cdots, s_l)$$
> 
> 则称其为 **最优反应**.

显然, 博弈中所有参与的博弈者都可以有属于它们自己的最优反应. 

并且, 在 **已知自己的所有对手都会做出什么样的决策** 的情况下, 我们自然可以选择出对于当前状态的一个最优反应. 

考虑更一般的情况, 如果存在某个决策, 使得己方在 **对手选择任何策略** 的情况下 **都是最优反应**, 那这样自然是最好的. 但需要注意的是, **绝大多数博弈** 中都 **不存在** 这么美好的情形. 下面给出具备这种性质的博弈需要满足的条件:

**命题 2.1.1**
> 若某个博弈者在一个:
>
> 1. 而人参与
> 2. 零和
> 3. 收益只能是 $\{-1, 0, 1\}$
>
> 的博弈中有一个必胜策略, 则该策略就是该博弈者在这个博弈中关于其他博弈者在 **任何情况** 下的最优反应.

显然, 很少有博弈能够实际满足上述的所有条件, 具备任何情况下的最优反应. 因此, 从实用的角度我们更关心下面的问题: 如何让博弈 **取得均衡**.

## 2.2 纳什均衡 (`Nash Equilibrium`)

**均衡理论** 就是研究 **那些可以使博弈的所有参与者都处于各自的最优反应** 的博弈策略的理论. 

我们实际上研究的是博弈中的 **均衡点**: 它表示 **全体博弈参与者各自的策略**, 这一组策略对于 **每个博弈者** 来说都是 **在当前状态下** 它的 **最优反应**. 

显然, 在均衡点上, 如果任何一个博弈者尝试 **单方面地** 改变策略, 则影响只会是: 它永不可能得到 **比当前更好的回报**, 因此每个博弈者都倾向于 (`has an incentive`) **维持当前的选择**.

**定义 2.2.1** (纳什均衡点 `Nash Equilibrium Point`)
> 称满足上述条件的, 每个博弈参与者的决策组成的元组 $(s_1^*, s_2^*\cdots, s_l^*)$ 为 **纳什均衡点**:
> 
> ![20221018230209](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221018230209.png)

我们同时称 $s_i^*$ 为 **对其他博弈者的, 互相的最优反应(`Simultaneous Best Responses`)**. 

需要注意, 如果在均衡点上, **其他所有的决策者都明确它们会做出位于平衡点上的决策**, 则剩下的唯一一个决策者为了自身的利益最大化, 能做出的最优决策也就是 **同样选择平衡点上的决策** 从而 **回应其他所有决策者做出的群体选择**. 这也是均衡点的一个性质.

这类均衡常被称为 **纳什均衡**, 我们在本章中不考虑其他更复杂的均衡概念. 

下面我们对 **双人**, **零和**, **信息完全** 且 **不包含概率因素** 的某一类博弈给出下列命题:

**命题 2.2.1**
> 对 **双人, 零和, 信息完全, 不包含概率因素** 且 **任何博弈主体可能的回报只可能是 $\{-1, 0, 1\}$** 的博弈, 下列 **三种可能情形** 中 **恰好可能成立一种**:
>
> ![20221018231240](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221018231240.png)


**均衡点** 概念背后的基本原则是: 它是所有博弈参与者的 “**平衡点**”: 如果只有其中一个博弈者偏离它，这个博弈者的回报将不可能比平衡点上的决策带来的回报更好, 这是因为在平衡点上, 每个博弈者都在对别人的 **集体选择** 做出最优反应.

我们下面将讨论在其他不同类型的博弈中是否仍存在均衡点.  

如果我们考虑 **完全指定的策略** (`Fully-Specified Strategy`), 则可考虑一个更强的概念:

**定义 2.2.2** (子博弈和子博弈均衡点 `Sub-Game, Sub-game Equilibrium Point`)
> 称 **博弈树中的子树** 为 **子博弈**. 
>
> 子博弈均衡点是每一个博弈参与者的 **完全指定的** 选择组成的决策元组, 这个元组是 **博弈中每个子博弈** 的均衡点:
> 
> ![20221018233126](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221018233126.png)

## 2.3 非零和博弈中的纳什均衡

我们下面考虑 **非零和博弈** 中是否存在纳什均衡点, 并讨论非零和博弈可能具有的性质.

非零和博弈中的主要问题是: **它可能存在不止一个纳什均衡点**, 但如果使用我们上面提到的原则和定义对博弈双方的最优反应进行计算, 得到的平衡点将是 **较差的那个**:

 
如 **囚徒困境** 中, 如果我们如此分析会得出, 表示为下图的标准形式所示的博弈中, 双方实际选择的平衡点是 `(talk, talk)` 而非会给双方都带来更好结果的另一个 `(don't talk, don't talk)`.

![20221019082816](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221019082816.png)

我们再来看一个 **多人囚徒困境** 的例子:

考虑 `TCP/IP` 拥塞控制协议: 所有 `TCP` 实现都需要支持称为 **慢启动** 的算法, 其的工作原理如下:

1. 初始状态, 将数据包批处理量的大小 (`Batch Size`) 约束为 $1$.
2. 将每次批量发送的数据包数量不断 **增加一倍**, 直到批量的大小达到预定义的阈值.
3. 从到达阈值开始, 每次传输时再将批次大小增加 $1$.
4. 当阻塞（在等待接受端发送的 `Acknoledgement` 时超时算作阻塞）时, 将阈值重置为当前 **批处理大小的一半** 并重新执行第一步中的流程.
   
其基本思想是: 使批处理的大小 **适应网络当前可支持的大小**. 由于每个用户都遵循相同的规则, 从而系统会在所有用户之间 **平均分配资源**, 显然这对集体而言公平的.

然而，对于某个单独的用户来说, 采用比上述慢启动更 “贪婪” 的算法是很诱人的: 比如直接跳回到新的阈值（而不是从批量大小为 $1$ 开始), 这样就可以挤占更多的资源. 

而如果每个用户都这样做, 网络带宽将会被榨干, 所有用户都无法以正常的速度发送和接收信息.

这显然是 **多人囚徒困境** 的情况: 若每个用户都克制追求自身的利益, 达成的结果对群体而言都有利, 每个用户也能获得相对更多的收益, 而在只有极少数人试图作弊时, 它们可以获得比平均水平更好的回报. (事实上, 即使每个用户都使用慢启动算法策略也不会导致均衡)

这显然是不符合任何博弈参与者的最大利益的. 这一问题的基本成因是: 我们在对问题进行建模时 **完全排除了博弈者之间沟通与合作的可能**.

由此可见:

1. 基于平衡点理论对博弈结果进行的计算可能在囚徒困境一般的情况下并不能得到理论上的最优解.

2. 在现实中博弈参与者并不完全表现得这般 “自私”.

因此可以使用下列的数种方法缓解纳什均衡理论的缺陷:

![20221019084056](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221019084056.png)

## 2.4 双人零和博弈中纳什均衡的性质

在完全考虑 **双人零和博弈** 时, 将 **达成该博弈的平衡点** 视为它的一个 **解** 的想法是非常有趣的. 下面给出在这种假设下的一系列性质.

首先考虑如何使用最简单的方式找到博弈的平衡点. 我们首先对双人零和博弈的收益情况进行如下图所示的形式化定义:

![20221019084750](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221019084750.png)

然后我们有下列的性质:

**命题 2.4.1**
> ![20221019084837](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221019084837.png)

**命题 2.4.2**
> ![20221019084904](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221019084904.png)

**引理 2.4.1**
> 双人零和博弈中的所有平衡点都会导致 **相同的回报**.

随后给出 **博弈的价值** 的定义:

**定义 2.4.1** (博弈的价值 `Value of the Game`)
> 对双人零和博弈, 它在平衡点上的 (**唯一的**) 收益被记为该博弈的 **价值**.

**命题 2.4.3**
> ![20221019085108](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221019085108.png)

从上面的命题可知: 如果得到了多个平衡点, 则通常可以将它们 **组合起来以得到更多的平衡点**. 

此外, 还可以将 **出现在某个平衡点的参与者 $1$ 的任何策略** 与 **出现在某个平衡点的参与者 $2$ 的任何策略** 配对从而 **得到另一个均衡点**. 

因此，为博弈参与者谈论均衡点策略是有意义的. 但是, 这仅在双人零和博弈的情况下才有意义.

故基于 “博弈的价值” 的定义, 有下列的命题:

**命题 2.4.4**
> ![20221019085345](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221019085345.png)

**命题 2.4.5**
>![20221019085430](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20221019085430.png)

## 2.5 混合策略



## 2.6 寻找纳什均衡

