---
layout:     post
title:      逻辑学探幽 Part9
subtitle:   没有逻辑 只有heip
date:       2021-11-19
author:     R1NG
header-img: img/post-bg-logicnotes.jpg
description: 本章介绍一种基于谓词公式的推广：量化布尔公式.
catalog: true
tags:
    - 逻辑学
    - 2021
---


# 量化布尔公式

在本章中, 我们介绍 **量化布尔公式** (`Quantified Boolean Formula`). 它是基于谓词公式的基础上推广而来的产物, 相比常规的谓词公式多出了 “存在 ( $\exist$)”, “任意 ($\forall$)” 等量化谓词, 因此相比普通的谓词公式, 我们可以使用它更简明地表达相同的问题. 一般而言, 量化布尔公式常被用于表示状态有限的组合问题, 如规划问题或博弈问题. 

我们将首先介绍量化布尔公式的语法和语义, 并解释 **界限变量** 和 **自由变量** 的定义和性质. 其次, 我们将讨论量化布尔公式的可满足性定义. 在此之后, 我们还将给出量化布尔公式的单调替换定理和等价替换定理, 最后我们研究量化布尔公式的代换 (`Substitution`).

我们随后给出量化布尔公式可成为的两种 **范式** (`Normal Form`): **前束范式** (`Prenex Form`) 与 **合取范式** (`CNF`). 

最后, 我们将介绍一系列检测量化布尔公式可满足性的方法.


## 9.1 量化布尔公式

我们首先在本节中介绍量化布尔公式的语法, 语义和它 **真假性**, **可满足性** 的定义, 进而说明对量化布尔公式而言, 检查它的某个解释的真值与检验该公式的可满足性或重言性同等困难的特征. 最后, 我们讨论量化布尔公式中的 **界限变量** 和 **自由变量**, 并由这两种新变量类型导致的, 无法在量化布尔公式上使用原本在常规谓词公式上可用的 “代换” 方法的问题, 引入对量化布尔公式的等价性和代换方法的讨论.

### 9.1.1 语法和语义

从本节开始我们将 **布尔变量** 简称为 **变量**. 量化布尔公式相比常规为此公式的推广是通过允许对公式中的变量使用量化谓词修饰而实现的. 

**定义 9.1.1** (量化布尔公式)
> 对量化布尔公式的定义相比谓词公式的定义, 只多出了下面的一条:<br>
> 考虑布尔变量 $p$ 和布尔公式 $F$, 则 $\forall p F$ 和 $\exists p F$ 也都是量化布尔公式. 

分别称 $\forall$ 和 $\exists$ 为 **全称量词** 和 **存在量词**. 

我们同时对量词表达式 $\forall p$, $\exists p$ 给出定义: 

1. 若公式 $F$ 中包含 $\forall p$, 则称在 $F$ 中, $p$ 为 **全称量化** (`Universally Quantified`) 的.

2. 若公式 $F$ 中包含 $\exists p$, 则称在 $F$ 中, $p$ 为 **存在量化** (`Existentially Quantified`) 的.

显然地, $\forall p F$ 和 $\exists p F$ 分别表示: 

1. 对 $p$ 的任意可能取值, $F$ 的解释均为真. 
2. 对 $p$ 的某一个可能取值, $F$ 的解释为真. 

下面讨论量化布尔公式的 **语义**. 

我们首先引入一个新的表述:

记 $I, p, b$ 分别为某个 **解释**, 某个 **变量** 和某个 **布尔值**. 则定义 $I[p \leftarrow b]$ 如下:

$$I[p \leftarrow b](q) \overset{def}{=} \begin{cases} I(q) ~~~ p \neq q \\ b ~~~~~~~~ p = q\end{cases} $$

显然对 $I[p \leftarrow b]$ 而言, 该解释由 $I$ 扩充而来, 它对其他任何不同于 $p$ 的变量的定义均与 $I$ 一致.

我们下面使用上面所定义的这个记号表述量化布尔公式的 **真性** (`Truth`):

**定义 9.1.2** (量化布尔公式的真性)
> 量化布尔公式的真性除了包含 [谓词公式的真性的定义] 外, 还包括下列两条:<br>
> 1. $I(\forall p F) = 1$ 当且仅当 $I[p \Leftarrow 0](F)=1$ 且 $I[p \Leftarrow 1](F)=1$.
> 2. $I(\exists p F) = 1$ 当且仅当 $I[p \Leftarrow 0](F)=1$ 或 $I[p \Leftarrow 1](F)=1$.

和谓词公式的情形一样, 若 $F$ 在解释 $I$ 下的语义为真, 则记为 $I \vDash F$.

**定义 9.1.3~9.1.5** (量化布尔公式的可满足性, 重言性, 等价性)
> 量化布尔公式的可满足性, 重言性和等价性与常规的谓词公式的定义一致.

需要注意的是, 对某个量化布尔公式而言, 给定它的某个解释进而检查该解释下给定量化布尔公式的值这一操作的复杂性和检验该布尔公式的可满足性等价.

这是因为一旦量化布尔公式中的任何变量被量化谓词修饰 (限定), 我们就需要根据修饰它的量化谓词的不同而相应地考虑不同的情况. 若变量被全称量词修饰, 我们必须考虑公式在该变量取得可取的每一个值的情况下对应的解释; 而若变量被存在量词修饰, 我们则要确保至少在该变量取到某一个值的情况下公式为真, 这也被称为 **构造 `AND-OR` 选择树**. 

![20211213080555](https://cdn.jsdelivr.net/gh/KirisameR/KirisameR.github.io/img/blogpost_images/20211213080555.png)



### 9.1.2 界限变量和自由变量

我们知道, 对谓词公式 $F$, 它的真值取决于 $F$ 中出现的所有变量 $p$ 的值. 而从上述的例子中可以看出, 对量化布尔公式 $G$ 而言, $G$ 在解释 $I$ 下的真值不完全取决于 $I$: $G$ 中任何被量词修饰的变量都会 **独立于解释 $I$** 对 $G$ 的真值产生影响, 这一影响不会随着 $I$ 对这些被修饰变量的值的限定而产生改变, 也就是说 $I$ 对这些被修饰变量的值的限定本质上是无效的.

**定义 9.1.6** (界限变量和自由变量)
> 对量化布尔公式 $F$ 而言, 若在它中所出现的某个变量 $p$ 被全称量词或存在量词中的任意一个所修饰, 则称其为 **界限变量**. 若 $p$ 在公式中没有被任何一种量词修饰, 则称其为 **自由变量**.

我们接下来对量化布尔公式的 **子式**, **极性**, 量化布尔公式中变量的 **自由出现** 和 **受限出现** 给出定义:

**定义 9.1.7** (量化布尔公式的子式)
> 对量化布尔公式的子式的定义相比谓词公式中的定义扩展了下列一条:<br>
> 公式 $F_1$ 是 $\forall p F_1$ 和 $\exists p F_1$ 的子式. 

**定义 9.1.8** (量化布尔公式的极性)
> 对量化布尔公式的极性的定义相比谓词公式中的定义扩展了下列一条:<br>
> 记 $F\vert _{\pi} = G$, 且 $G$ 形为 $\forall p G_1$ 或 $\exists p G_1$. 则 $\pi . 1$ 为 $F$ 中的一个 **位置**, 且 $F \vert _{\pi.1} \overset{def}{=} G_1$ 且 $\text{pol}(F, \pi.1) \overset{def}{=} \text{pol}(F, \pi).$

注: 在量化布尔公式中, 我们沿用 “谓词公式的极性” 定义中, “正出现” 与 “负出现” 的定义. 

**定义 9.1.9** (量化布尔公式中变量的自由出现与受限出现)
> 考虑布尔变量 $p$, 且 $F\vert _{\pi} = p$ (即 $p$ 在量化布尔公式 $F$ 中), 称 “$p$ 在量化布尔公式 $F$ 的位置 $\pi$ 上的一次出现” 为 **受限出现**, 若这次出现所在的位置 $\pi$ 可表示为两个子位置 $\pi_1, \pi_2$ 的联结, 且 $F\vert _{\pi_1}$ 形如 $\forall p G$ 或 $\exists p G$, 反之称这次出现为 **自由出现**. 

上述的形式化定义用人话表示, 就是说, 若变量 $p$ 在 $F$ 的某个位置上被某种量化谓词修饰, 则称 $p$ 的这次出现为 **受限出现**, 反之这次出现则为 **自由出现**. 

**定义 9.1.10** (自由变量与受限变量)
> 这个定义是 `定义 9.1.9` 的推广. 若 $F$ 中的某个变量 $p$ 在其中有至少一次受限出现 (或自由出现) , 称其为 $F$ 的受限变量 (或自由变量). 

需要注意的是, 量化布尔公式中的一个变量可以 **既是自由变量, 同时也是受限变量**, 如 

$$p \rightarrow \forall q \exists p (q \leftrightarrow p) \vee r$$

中, 变量 $p$ 的第一次出现是自由的, 而最后一次出现就是受限的. 同时, $q$ 在该公式中只有受限出现, $r$ 只有自由出现. 

我们最后引入一个记号. 从此开始, 我们使用记号 $\exists\forall$ 表示 “任一种量词”.

**定义 9.1.11** (闭的量化布尔公式)
> 称量化布尔公式为 **闭** 的, 若该公式中不存在任何自由变量.



### 9.1.3 真性和满足性

我们下面讨论如何检验量化布尔公式的真性和可满足性. 

首先基于第一小节中对量化布尔公式真性的定义, 我们不难得出下列结论: **量化布尔公式的真值只取决于它自由变量的值**.

**引理 9.1.1**
> 记 $I_1, I_2$ 为对量化布尔公式 $F$ 上所有自由变量具有相同定义的两个解释, 则 $I_1 \vDash F$ 当且仅当 $I_2 \vDash F$.

由上述结论, 我们可得到这个结果:

**引理 9.1.2**
> 对 **闭的量化布尔公式** 而言, 它的 **真性**, **重言性**, **可满足性** 等价: <br>
> 对任意解释 $I$ 和闭的量化布尔公式 $F$, 下列三个命题等价:
> 1. $I \vDash F$.
> 2. $F$ 是可满足的.
> 3. $F$ 是重言式.

**证明**<br>
首先可知, $F$ 为重言式 $\Rightarrow I \vDash F \Rightarrow F$ 为可满足的.

其次可知, 若 $F$ 为可满足的, 则存在某个解释 $I_1$ 满足 $I_1 \vDash F$. 由 `引理 9.1.1`, 知任何与 $I_1$ 对于 $F$ 的自由变量具有相同定义的解释 $I_2$ 同样满足 $I_2 \vDash F$. 由于 $F$ 不存在自由变量, 因此对任意 $I_2$, 均满足 $I_2 \vDash F$. 因此 $F$ 为重言式. $\blacksquare$

一般地, 我们可将量化布尔公式的可满足性和真性视为 **闭的量化布尔公式的可满足性 (或真性/重言性) 的特殊情况**.

**引理 9.1.3**
> 记 $F$ 为量化布尔公式, 其自由变量为 $p_1, p_2, \cdots, p_n$, 则 $F$ 为可满足的 (或重言的), 当且仅当 **闭的量化布尔公式** $\exists p_1, \exists p_2, \cdots, \exists p_n F$ (或 $\forall p_1, \forall p_2, \cdots, \forall p_n F$) 为可满足的.

### 9.1.4 等价性: 单调替换定理和等价替换定理

我们下面考虑定义在量化布尔公式中定义谓词公式所具备的单调替换定理和等价替换定理. 

**定理 9.1.1** (量化布尔公式的单调替换定理)
> 记 $F_1$ 为量化布尔公式 $G_1$ 的子式, 且 $F_1 \rightarrow F_2$ 为重言式. 将 $G_1$ 中 **至少一处$F_1$ 的正出现 (或负出现)** 用 $F_2$ 替代, 则公式 $G_1 \rightarrow G_2$ (或 $G_2 \rightarrow G_1$) 也是重言的.

换言之, 量化布尔公式的真值在正出现的子公式上是单调的, 在负出现的子公式上是反单调的. 

我们进而有下述的等价替换定理:

**定理 9.1.2** (量化布尔公式的等价替换定理)
> 记 $F_1$ 为量化布尔公式 $G_1$ 的子公式, 且 $F_1 \equiv F_2$. 记 $G_2$ 为从 $G_1$ 中替换至少一处 $F_1$ 出现为 $F_2$ 得到的公式, 则 $G_1 \equiv G_2$.

### 9.1.5 代换



## 9.2 范式

### 9.2.1 前束范式

### 9.2.2 合取范式



## 9.3 可满足性检测: 分割算法和DPLL算法

